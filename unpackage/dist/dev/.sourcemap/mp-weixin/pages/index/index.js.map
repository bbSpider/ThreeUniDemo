{"version":3,"sources":["uni-app:///main.js","webpack:///E:/uniAppWorkspace/2021.12.29/demoUni/pages/index/index.vue?ed91","webpack:///E:/uniAppWorkspace/2021.12.29/demoUni/pages/index/index.vue?b9be","webpack:///E:/uniAppWorkspace/2021.12.29/demoUni/pages/index/index.vue?1d94","uni-app:///pages/index/index.vue","webpack:///E:/uniAppWorkspace/2021.12.29/demoUni/pages/index/index.vue?6c76","webpack:///E:/uniAppWorkspace/2021.12.29/demoUni/pages/index/index.vue?549f"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","qiunDataCharts","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped"],"mappings":";;;;wEAAA,qBACA,sBACA,yC,mDAFmBA,GAAGC,kCAAoCC,EAG1DC,EAAWC,a;;;;2DCHX,yaACIC,EADJ,iHASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,wBACZ,aAAAF,E;;;;2GCvBf,q9B;;;;2DCAA,qeAAm3B,eAAG,G;;;;6HCmWt3B,sCACA,mCAOA,mEAIA,mD,2KATA,kCAEA,sCAYA,SAUA,QAiCA,aAcA,QAvEA,I,EA2HA,CAEA,KAFA,WAEA,MACA,UACA,QACA,aACA,cACA,QACA,iCACA,yBACA,SACA,QACA,QACA,cACA,aACA,aACA,WACA,OACA,gBACA,iBACA,aACA,kBACA,YACA,OACA,mBACA,eACA,WACA,YACA,cACA,iBA1BA,oBA2BA,MA3BA,gBA4BA,GA5BA,gBA6BA,CAEA,YACA,OACA,OACA,OACA,OACA,OACA,QAEA,SACA,YACA,MACA,GACA,EACA,GACA,GACA,EACA,KAGA,CACA,YACA,MACA,GACA,GACA,GACA,IACA,GACA,QA1DA,I;;;;2DCpeA,0qBAA6uC,eAAG,G;;;;;;;;2GCAhvC,IAAIG,EAAJ,0LACA,IACEA,EAAa,CACXC,eAAgB,WACd,OAAO,8TAKX,MAAOC,GACP,IAC+C,IAA7CA,EAAEC,QAAQC,QAAQ,wBACa,IAA/BF,EAAEC,QAAQC,QAAQ,QAWlB,MAAMF,EATNG,QAAQC,MAAMJ,EAAEC,SAChBE,QAAQC,MAAM,mBACdD,QAAQC,MACN,uFAEFD,QAAQC,MACN,mDAMN,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,I","file":"pages/index/index.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=57280228&filter-modules=eyJ0aHJlZSI6eyJ0eXBlIjoicmVuZGVyanMiLCJjb250ZW50IjoiIiwic3RhcnQiOjgzMjEsImF0dHJzIjp7Im1vZHVsZSI6InRocmVlIiwibGFuZyI6ImpzIn0sImVuZCI6MTE3NzB9fQ%3D%3D&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/index.vue\"\nexport default component.exports","export * from \"-!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=57280228&filter-modules=eyJ0aHJlZSI6eyJ0eXBlIjoicmVuZGVyanMiLCJjb250ZW50IjoiIiwic3RhcnQiOjgzMjEsImF0dHJzIjp7Im1vZHVsZSI6InRocmVlIiwibGFuZyI6ImpzIn0sImVuZCI6MTE3NzB9fQ%3D%3D&\"","import mod from \"-!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\r\n\t<view class=\"container\">\r\n\r\n\t\t<view class=\"top-switch\">\r\n\t\t\t<view class=\"switch-type\">\r\n\t\t\t\t<view class=\"btn\" :class=\"[currentSelectTripType=='training'?'active':'']\" @click=\"selectedXunlian\"\r\n\t\t\t\t\tdata-id='training'>训练模式\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"btn\" :class=\"[currentSelectTripType=='study'?'active':'']\" @click=\"selectedStudy\"\r\n\t\t\t\t\tdata-id='study'>\r\n\t\t\t\t\t学习模式\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\r\n\t\t<!-- 上面部分 -->\r\n\t\t<view class=\"canvas\">\r\n\r\n\r\n\r\n\t\t\t<!-- 画布展示模型 -->\r\n\t\t\t<view class=\"canvas-style\">\r\n\r\n\t\t\t\t<view id=\"three\" class=\"three\" @click=\"three.onClick\"></view>\r\n\r\n\t\t\t\t<!-- <canvas type=\"webgl\" id=\"webgl\"\r\n\t\t\t\t\tstyle='width:100%;height:250px;background-color:rgb(255, 255, 255,1); margin: aotu 0;'>\r\n\r\n\t\t\t\t\t<view class=\"electric-background\">\r\n\t\t\t\t\t\t<image v-if=\"connectStatus==false\" class=\"electric-img\"\r\n\t\t\t\t\t\t\tsrc=\"/static/images/electric/electric4.png\">\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t<image v-if=\"electric>=6&&electric<=10&&connectStatus==true\" class=\"electric-img\"\r\n\t\t\t\t\t\t\tsrc=\"/static/images/electric/electric3.png\">\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t<image v-if=\"electric>=2&&electric<=5&&connectStatus==true\" class=\"electric-img\"\r\n\t\t\t\t\t\t\tsrc=\"/static/images/electric/electric2.png\">\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t<image v-if=\"electric>=0&&electric<=1&&connectStatus==true\" class=\"electric-img\"\r\n\t\t\t\t\t\t\tsrc=\"/static/images/electric/electric1.png\">\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t</canvas> -->\r\n\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\r\n\r\n\t\t<!-- 左右旋转 -->\r\n\t\t<view class=\"rotate\" v-if=\"currentSelectTripType == 'study'\">\r\n\t\t\t<image @click=\"rotate()\" bindlongpress=\"rotateAnimate\" data-index=\"0\" class=\"im-rotate-left\"\r\n\t\t\t\tsrc=\"/static/images/courseImg/icon-similarity-left.png\" bindtouchstart=\"touchStart\"\r\n\t\t\t\tbindtouchend=\"touchEnd\">\r\n\t\t\t</image>\r\n\r\n\t\t\t<image @click=\"correct()\" class=\"correct-imgOne\" src=\"../../static/images/courseImg/rest-last.png\">\r\n\t\t\t</image>\r\n\r\n\t\t\t<image @click=\"rotate()\" bindlongpress=\"rotateAnimate\" data-index=\"1\" class=\"im-rotate-right\"\r\n\t\t\t\tsrc=\"/static/images/courseImg/icon-similarity-right.png\" bindtouchstart=\"touchStart\"\r\n\t\t\t\tbindtouchend=\"touchEnd\">\r\n\t\t\t</image>\r\n\t\t</view>\r\n\r\n\t\t<!-- 左右旋转 -->\r\n\t\t<view class=\"rotate\" v-if=\"currentSelectTripType == 'training'\">\r\n\t\t\t<image @click=\"rotate()\" v-if=\"bEnd==false\" bindlongpress=\"rotateAnimate\" data-index=\"0\"\r\n\t\t\t\tclass=\"im-rotate-left\" src=\"/static/images/courseImg/icon-similarity-left.png\"\r\n\t\t\t\tbindtouchstart=\"touchStart\" bindtouchend=\"touchEnd\">\r\n\t\t\t</image>\r\n\t\t\t<image @click=\"correct()\" v-else-if=\"bEnd==false\" class=\"correct-imgOne\"\r\n\t\t\t\tsrc=\"/static/images/courseImg/rest-last.png\">\r\n\t\t\t</image>\r\n\t\t\t<image @click=\"rotate()\" v-else-if=\"bEnd==false\" bindlongpress=\"rotateAnimate\" data-index=\"1\"\r\n\t\t\t\tclass=\"im-rotate-right\" src=\"/static/images/courseImg/icon-similarity-right.png\"\r\n\t\t\t\tbindtouchstart=\"touchStart\" bindtouchend=\"touchEnd\">\r\n\t\t\t</image>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"canvas-down\">\r\n\r\n\t\t\t<view v-if=\"currentSelectTripType == 'training'\" class=\"canvas-button-play\">\r\n\t\t\t\t<view class=\"button-left\" @click=\"payAdvanceTrain()\">前进</view>\r\n\t\t\t\t<view class=\"button-left\" @click=\"trainBack()\">播放</view>\r\n\t\t\t\t<view class=\"button-left\" @click=\"payBackTrain()\">回退</view>\r\n\r\n\t\t\t\t<!-- <view class=\"button-left\" v-if=\"frontTrain==true\" bindtap=\"payAdvanceTrain\">前进</view>\r\n\t\t\t\t<view class=\"button-left-unable\" v-else-if=\"frontTrain==false\">前进</view>\r\n\t\t\t\t<view class=\"button-left\" v-if=\"playTrain==true\" bindtap=\"trainBack\">播放</view>\r\n\t\t\t\t<view class=\"button-left-unable\" v-else-if=\"playTrain==false\">播放</view>\r\n\t\t\t\t<view class=\"button-left\" v-if=\"backTrain==true\" bindtap=\"payBackTrain\">回退</view>\r\n\t\t\t\t<view class=\"button-left-unable\" v-else-if=\"backTrain==false\">回退</view> -->\r\n\t\t\t</view>\r\n\r\n\t\t\t<view v-if=\"currentSelectTripType == 'study'\" class=\"canvas-button-play\">\r\n\r\n\t\t\t\t<view class=\"button-left\" v-if=\"front==true\" @click=\"payAdvance()\">前进</view>\r\n\t\t\t\t<view class=\"button-left-unable\" v-else-if=\"front==false\">前进</view>\r\n\t\t\t\t<view class=\"button-left\" v-if=\"play==true\" @click=\"playBackData()\">播放</view>\r\n\t\t\t\t<view class=\"button-left-unable\" v-else-if=\"play==false\">播放</view>\r\n\t\t\t\t<view class=\"button-left\" v-if=\"back==true\" @click=\"payBack()\">回退</view>\r\n\t\t\t\t<view class=\"button-left-unable\" v-else-if=\"back==false\">回退</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view v-if=\"currentSelectTripType == 'training'\" class=\"canvas-button\">\r\n\t\t\t\t<view v-if=\"bEnd==true\" class=\"canvas-button-left\" @click=\"updateStartTrain()\">开始</view>\r\n\t\t\t\t<view v-else class=\"canvas-button-right\" @click=\"updateEndTrain()\">结束</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 拍次 -->\r\n\t\t\t<view class=\"canvas-text\">\r\n\t\t\t\t<view class=\"canvas-left\">\r\n\t\t\t\t\t<text class=\"canvas-text-up\">目标拍次：{{content_count}}次</text>\r\n\t\t\t\t\t<text class=\"canvas-text-down\">训练拍次：{{train_count}}次</text>\r\n\t\t\t\t\t<text class=\"canvas-text-down\">挥拍轨迹相似度：{{similarityOld}}</text>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 上一拍和下一拍按钮 -->\r\n\t\t\t\t<view class=\"right-button\" v-if=\"currentSelectTripType == 'training'\">\r\n\r\n\t\t\t\t\t<view class=\"canvas-right-button-checkedStyle\" @click=\"lastTake()\">上一拍\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"canvas-right-button-checkedStyleBottom\" @click=\"nextTake()\">下一拍\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- <view class=\"canvas-right-button-checkedStyle\" v-if=\"isStartTake==false\" bindtap=\"lastTake\">上一拍\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"canvas-right-button-style\" v-if=\"isStartTake==true\">上一拍</view>\r\n\r\n\t\t\t\t\t<view class=\"canvas-right-button-checkedStyleBottom\" v-if=\"isEndTake==false\"\r\n\t\t\t\t\t\tbindtap=\"nextTake\">下一拍</view>\r\n\t\t\t\t\t<view class=\"canvas-right-button-styleBottom\" v-if=\"isEndTake==true\">下一拍</view> -->\r\n\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"canvas-right-train\" v-if=\"currentSelectTripType == 'training'\">\r\n\t\t\t\t\t<image @click=\"resetPosition()\" class=\"correct-img\"\r\n\t\t\t\t\t\tsrc=\"https://www.szearth.cn/SZearth/wx_images/3D-pattern/bat_correct_text.png\">\r\n\t\t\t\t\t</image>\r\n\t\t\t\t</view>\r\n\r\n\r\n\t\t\t\t<view class=\"canvas-right\" v-if=\"currentSelectTripType == 'study'\"></view>\r\n\r\n\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"bottom-data\">\r\n\t\t\t<!-- <view class=\"mychart\"> -->\r\n\t\t\t<!-- <ec-canvas id=\"mychart\" canvas-id=\"mychart-multi\" ec=\"{{ ec }}\"></ec-canvas> -->\r\n\t\t\t<!-- <ec-canvas id=\"mychart\" canvas-id=\"mychart-multi\"></ec-canvas> -->\r\n\r\n\t\t\t<!-- 使用插件 ucharts -->\r\n\t\t\t<view class=\"charts-box\">\r\n\t\t\t\t<qiun-data-charts type=\"area\" :chartData=\"chartData\" :echartsApp=\"true\" :errorReload=\"false\"\r\n\t\t\t\t\tbackground=\"none\" :tooltipShow=\"false\" />\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- </view> -->\r\n\t\t</view>\r\n\r\n\t\t<view class=\"canvas-similarity\">发力曲线相似度：{{similarity}}</view>\r\n\r\n\t\t<view>\r\n\t\t\t<!-- 展示数据列表 -->\r\n\t\t\t<!-- <van-collapse style=\"width: 100%;\" value=\"{{ activeNames }}\" bind:change=\"onChange\">\r\n\t\t\t\t<block calss=\"course\" wx:for=\"{{item.list}}\" wx:for-item=\"item2\" wx:for-index=\"index\">\r\n\t\t\t\t\t<view class=\"course-content\">\r\n\t\t\t\t\t\t<view class=\"course-content-title\">\r\n\t\t\t\t\t\t\t<view class=\"content-title-con\">相似度：{{item2.content_title}}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</block>\r\n\t\t\t</van-collapse> -->\r\n\t\t</view>\r\n\r\n\t\t<view class=\"bottom-performance\" @click=\"toResults()\">查看训练结果</view>\r\n\r\n\t\t<view class=\"selector\" v-if=\"currentSelectTripType == 'training'\">\r\n\t\t\t<view class=\"selector-content\">\r\n\t\t\t\t<view class=\"picker\">\r\n\t\t\t\t\t<picker mode=\"date\" :value=\"date\" start=\"2020-01-01\" :end=\"chooseEndTime\"\r\n\t\t\t\t\t\tbindchange=\"bindDateChange\">\r\n\t\t\t\t\t\t请选择日期：{{date}}\r\n\t\t\t\t\t\t<image src=\"/static/images/courseImg/choose.png\" class=\"choose-img\"></image>\r\n\t\t\t\t\t</picker>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"take\">拍次：{{frequency}}次</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"data-result-list\" v-if=\"currentSelectTripOpen\">\r\n\t\t\t<view class=\"list-title\">\r\n\t\t\t\t<view class=\"title\">拍次</view>\r\n\t\t\t\t<view class=\"title\">时间</view>\r\n\t\t\t\t<view class=\"title\">相似度</view>\r\n\t\t\t\t<view class=\"title\">轨迹</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<block v-for=\"(item, index) in lists\">\r\n\t\t\t\t<view class=\"list-title list-data\" :class=\"[current_item==item.id?'list-data-checked':'']\">\r\n\t\t\t\t\t<view class=\"title\">{{item.number}}</view>\r\n\t\t\t\t\t<view class=\"title\">{{item.time}}</view>\r\n\t\t\t\t\t<view class=\"title\">[{{item.similarity}}==''?0:{{item.similarity}}]%</view>\r\n\t\t\t\t\t<!-- <view class=\"check\" bindtap=\"check\" data-index='{{item.id}}'>查看</view> -->\r\n\t\t\t\t\t<view class=\"check\" @click=\"check()\" :id=\"item.id\">查看</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"lin\"></view>\r\n\t\t\t</block>\r\n\t\t</view>\r\n\r\n\t</view>\r\n\r\n\t</view>\r\n\r\n</template>\r\n\r\n<!-- 只能在APP和h5端运行 -->\r\n<script module=\"three\" lang=\"renderjs\">\r\n\t// import GLTFLoader from '../../static/GLTFLoader.js'\r\n\r\n\r\n\tvar that;\r\n\tlet myThree;\r\n\tvar renderer;\r\n\tvar scene;\r\n\tvar camera;\r\n\tvar mesh;\r\n\tvar T0;\r\n\texport default {\r\n\t\tmounted() {\r\n\t\t\tthat = this;\r\n\t\t\tconsole.log(\"调用：\", window.three);\r\n\t\t\tif (typeof window.three === 'function') {\r\n\t\t\t\tthis.initThree()\r\n\t\t\t} else {\r\n\t\t\t\t// 动态引入较大类库避免影响页面展示\r\n\t\t\t\tconst script = document.createElement('script')\r\n\t\t\t\t// view 层的页面运行在 www 根目录，其相对路径相对于 www 计算\r\n\t\t\t\tscript.src = 'static/three.min.js';\r\n\t\t\t\tscript.onload = this.initThree.bind(this)\r\n\t\t\t\tdocument.head.appendChild(script)\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tinitThree() {\r\n\t\t\t\t// 如果返回的不是未定义，说明threejs成功引入\r\n\t\t\t\tconsole.log('打印场景API:', THREE.Scene);\r\n\t\t\t\tconsole.log('打印场景API:', JSON.stringify(THREE));\r\n\r\n\t\t\t\t/* 创建场景对象Scene */\r\n\t\t\t\tscene = new THREE.Scene();\r\n\t\t\t\t/* \r\n\t\t\t\t    创建网格模型\r\n\t\t\t\t */\r\n\t\t\t\tvar geometry = new THREE.BoxGeometry(100, 100, 100); // 创建一个立方几何对象（长宽高）\r\n\t\t\t\tvar material = new THREE.MeshLambertMaterial({\r\n\t\t\t\t\tcolor: 0x0000ff\r\n\t\t\t\t}); // 材质对象\r\n\t\t\t\tmesh = new THREE.Mesh(geometry, material); // 网格模型对象\r\n\t\t\t\tscene.add(mesh); // 网格模型添加到场景中\r\n\t\t\t\t/* \r\n\t\t\t\t    光源设置\r\n\t\t\t\t */\r\n\t\t\t\t//  点光源--光照强度\r\n\t\t\t\tvar point = new THREE.PointLight(0xffffff);\r\n\t\t\t\tpoint.position.set(400, 200, 300); // 点光源位置\r\n\t\t\t\tscene.add(point); // 点光源添加到场景中\r\n\t\t\t\t// 环境光\r\n\t\t\t\tvar ambient = new THREE.AmbientLight(0x444444);\r\n\t\t\t\tscene.add(ambient);\r\n\t\t\t\t/* \r\n\t\t\t\t    相机设置\r\n\t\t\t\t */\r\n\t\t\t\tvar width = window.innerWidth; // 窗口宽度\r\n\t\t\t\tvar height = window.innerHeight; // 高度\r\n\t\t\t\tvar k = width / height; // 窗口宽高比\r\n\t\t\t\tvar s = 200; // 三维场景显示范围控制系数，系数越大，显示的范围越大\r\n\t\t\t\t// 创建相机对象（正射投影）\r\n\t\t\t\tcamera = new THREE.OrthographicCamera(-s * k, s * k, s, -s, 1, 1000);\r\n\t\t\t\tcamera.position.set(200, 300, 200); // 设置相机位置\r\n\t\t\t\tcamera.lookAt(scene.position); // 设置相机的方向（指向场景对象）\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * 导入外部模型\r\n\t\t\t\t */\r\n\t\t\t\tvar loader = new THREE.GLTFLoader();\r\n\t\t\t\t// let loader = gltf.GLTFLoader();\r\n\t\t\t\t// var loader = new GLTFLoader();\r\n\t\t\t\t//导入资源\r\n\t\t\t\tloader.load(\r\n\t\t\t\t\t//obj模型所在url\r\n\t\t\t\t\t// 'obj/male02/male02.obj',\r\n\t\t\t\t\t'static/model/badminton.glb',\r\n\t\t\t\t\t// 资源加载成功后执行的函数 \r\n\t\t\t\t\t//@params object 传入的模型，只能是单个模型，也可能是一个group,视构建的model而定 \r\n\t\t\t\t\tfunction(object) {\r\n\t\t\t\t\t\t//taverse函数为遍历object的每个子mesh，传入的child为每个mesh\r\n\t\t\t\t\t\t//该示例中的object为一个group，有多个mesh组成\r\n\t\t\t\t\t\tobject.traverse(function(child) {\r\n\t\t\t\t\t\t\tif (child instanceof THREE.Mesh) {\r\n\t\t\t\t\t\t\t\tchild.material.map = texture;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tobject.position.y = -95;\r\n\t\t\t\t\t\tscene.add(object);\r\n\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t/* \r\n\t\t\t\t    创建渲染器对象\r\n\t\t\t\t */\r\n\t\t\t\trenderer = new THREE.WebGLRenderer();\r\n\t\t\t\trenderer.setSize(width, height); // 设置渲染区域尺寸\r\n\t\t\t\trenderer.setClearColor(0xb9d3ff, 1); // 设置背景颜色\r\n\t\t\t\tdocument.body.appendChild(renderer.domElement); // body元素中插入canvas对象\r\n\t\t\t\t// 执行渲染操作，指定场景，相机作为参数\r\n\t\t\t\trenderer.render(scene, camera);\r\n\t\t\t},\r\n\t\t\t// 动画\r\n\t\t\trender() {\r\n\r\n\t\t\t\tlet T1 = new Date(); //本次时间\r\n\t\t\t\tlet t = T1 - T0; //时间差\r\n\t\t\t\tT0 = T1; //把本次时间赋值给上次时间\r\n\t\t\t\t// 第一种循环方式\r\n\t\t\t\t// setInterval(function(){ that.render() }, 20);\r\n\t\t\t\t// 建议使用requestAnimationFrame循环\r\n\t\t\t\trequestAnimationFrame(function() {\r\n\t\t\t\t\tthat.render();\r\n\t\t\t\t});\r\n\t\t\t\trenderer.render(scene, camera); //执行渲染操作\r\n\t\t\t\t// mesh.rotateY(0.01);//每次绕y轴旋转0.01弧度\r\n\t\t\t\tmesh.rotateY(0.001 * t); //旋转角速度0.001弧度每毫秒\r\n\t\t\t},\r\n\t\t\t// 点击事件-点击开始\r\n\t\t\tonClick(event, ownerInstance) {\r\n\t\t\t\tT0 = new Date();\r\n\t\t\t\tthat.render();\r\n\t\t\t\t// 调用 service 层的方法\r\n\t\t\t\townerInstance.callMethod('onViewClick', {\r\n\t\t\t\t\tdata: '我点击了3d图形'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n\r\n<script>\r\n\timport http from '../../utils/request.js';\r\n\timport util from '../../utils/util.js';\r\n\r\n\tconst com_2d = require('../../utils/com_2d.js');\r\n\r\n\tconst format = require('../../utils/formatData.js');\r\n\r\n\r\n\timport {\r\n\t\tcreateScopedThreejs\r\n\t} from '../../wxcomponents/miniprogram_npm/threejs-miniprogram'\r\n\r\n\timport {\r\n\t\tregisterGLTFLoader\r\n\t} from '../../wxcomponents/loaders/gltf-loader'\r\n\r\n\r\n\tlet app = getApp();\r\n\r\n\tlet canvaWidth = 0; //画布宽\r\n\tlet canvaHeight = 0; //画布高\r\n\tlet canvas, THREE; //3d相关\r\n\tlet flog = 0,\r\n\t\taddYet = 0; //标识\r\n\tlet camera, scene, renderer, model; //定义变量： 摄像机(camera) 场景(scene) 渲染器(renderer) 模型(model)\r\n\tlet pagestatus = 0; //函数返回\r\n\tlet cube; // 物体\r\n\tlet a2h_dip = Math.PI / 180;\r\n\tlet x_pi = 180,\r\n\t\ty_pi = 0,\r\n\t\tz_pi = -90; // 未让z轴每次-90前\r\n\tlet zero_z = 1; //屏幕朝向校正\r\n\r\n\tlet isShowLoading = false;\r\n\tlet isShowToast = false;\r\n\tlet showErr = 0; //标识\r\n\r\n\tlet courseId;\r\n\tlet contentId = 9;\r\n\r\n\tlet num = 0; //计算目前存了多少包\r\n\tlet ahrsData = []; //保存欧拉角\r\n\tlet gyroData = []; //保存转速度\r\n\tlet accData = []; //保存加速度\r\n\r\n\tlet axle_x = 0; //存储校验 xyz\r\n\tlet axle_y = 0;\r\n\tlet axle_z = 0;\r\n\tlet verify = false; //是否点击确认\r\n\r\n\tlet curveArray = []; //保存转速度的值\r\n\r\n\t// let startTime; //点击开始按钮的时间戳\r\n\tlet yqData; //存打球数据\r\n\r\n\tlet cube2; //线模型\r\n\tvar sphere1; //顶点\r\n\r\n\tlet mainlineArry = []; //存面数组\r\n\r\n\tvar arr1 = new Array(3);\r\n\r\n\tlet curveTeach = []; //保存教师打球数据\r\n\tlet axisTeacher = []; //保存x轴数据\r\n\r\n\tlet teacherData = []; //数据库数据\r\n\r\n\tlet playbackData = []; //回放数据 模型回放\r\n\tlet mainlineArryGet = []; //保存面数据 用于清除\r\n\r\n\tlet camera_parent; //透明模型\r\n\r\n\tlet listValue = []; //获取底部列表的值\r\n\r\n\tlet angle = Math.PI / 180; //角度 用来复位模型\r\n\r\n\tlet p0_Back = 0; //标识曲线最后一个显示下标\r\n\tlet p1_Back = 0; //训练模式标识\r\n\r\n\tlet goStatus = true; // 回放时 前进的状态值\r\n\tlet backStatus = false; // 回放时 回退的状态值 \r\n\r\n\tlet backArr = []; // 保存训练模式回放的数据\r\n\r\n\tlet takeCount = 0; //训练模式，当前显示的模型轨迹下标\r\n\r\n\tlet connTimestamp; //连接上蓝牙时的时间戳\r\n\r\n\tlet showCount = 0; //提示用户充电，只提示一次\r\n\r\n\tlet adjustAngle = 0; //训练模式自动矫正角度\r\n\r\n\tlet maxIndexTeach = 0; //教师数据最大值下标\r\n\r\n\tlet curveArry = []; //前进回退过程，保存教师曲线数据\r\n\r\n\tlet frequency = 0; //当天拍次\r\n\r\n\tlet countArry = [];\r\n\r\n\tlet durationTime = 40; //设置回放速度 包括回放发力曲线和轨迹\r\n\r\n\tlet max = 0; //设置发力曲线最大值\r\n\r\n\tlet make = 0; //绘制一次轨迹标记\r\n\r\n\tlet courseTitle = \"\"; //课程标题\r\n\r\n\tlet curveArrayTrain = []; //训练\r\n\r\n\tlet speedMin = 0; //最小速度 教师动作\r\n\tlet total = 0; //满足条件的值\r\n\r\n\tlet shieldMin = 0.6; //最小屏蔽\r\n\tlet shieldMax = 1.7; //最大屏蔽\r\n\r\n\tlet testPoint = [];\r\n\r\n\tlet timeEnd = 0; //挥拍结束时间\r\n\tlet timeStart = 0; //下一次挥拍开始时间\r\n\tlet intervalTime = 0; //相差时间\r\n\r\n\t//设置默认值\r\n\tlet openId = \"odcCw4vgneOlRaI6pKzzZBR1fp8M\";\r\n\tlet startTime = \"2021-12-29 10:00:00\";\r\n\r\n\texport default {\r\n\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tbEnd: true, //是否结束\r\n\t\t\t\twireframe: false, //默认设置成轨迹面样式\r\n\t\t\t\tisplayBack: false, //是否正在回放模型 false代表当前没有在回放\r\n\t\t\t\tswing: 0, // 0 未在挥拍 1 在挥拍\r\n\t\t\t\tcurrentSelectTripType: 'training',\r\n\t\t\t\tcurrentSelectTripOpen: true, //默认显示列表\r\n\t\t\t\tfront: false, //前进按钮样式改变\r\n\t\t\t\tback: false, //回退按钮样式改变\r\n\t\t\t\tplay: false, //播放按钮样式改变\r\n\t\t\t\tfrontTrain: false, //前进按钮样式改变\r\n\t\t\t\tbackTrain: false, //回退按钮样式改变\r\n\t\t\t\tplayTrain: false, //播放按钮样式改变\r\n\t\t\t\tchecked: false, //训练模式 查看的选中效果\r\n\t\t\t\tsrc: '', //路径\r\n\t\t\t\tsimilarity: 0 + '%', //相似度\r\n\t\t\t\tconnectStatus: false, //是否连接成功\r\n\t\t\t\tconnected: false, //是否正在连接\r\n\t\t\t\tactiveNames: [\"0\"],\r\n\t\t\t\ticonShow: false, //显示左右旋转按钮\r\n\t\t\t\tvid: \"\",\r\n\t\t\t\tsimilarityOld: '0%', //之前相似度\r\n\t\t\t\telectricShow: 0, //页面显示电量\r\n\t\t\t\telectric: 0, //电量\r\n\t\t\t\tcosXsd: '0%', //余弦相似度\r\n\t\t\t\ttrain_count: 0, //训练拍次\r\n\t\t\t\tcontent_count: 0, //目标拍次\r\n\t\t\t\tsimilarityOld: '0%', //相似度\r\n\t\t\t\tfrequency: 0, //拍次\r\n\t\t\t\tchartData: {\r\n\r\n\t\t\t\t\t\"categories\": [\r\n\t\t\t\t\t\t\"2016\",\r\n\t\t\t\t\t\t\"2017\",\r\n\t\t\t\t\t\t\"2018\",\r\n\t\t\t\t\t\t\"2019\",\r\n\t\t\t\t\t\t\"2020\",\r\n\t\t\t\t\t\t\"2021\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"series\": [{\r\n\t\t\t\t\t\t\t\"name\": \"成交量A\",\r\n\t\t\t\t\t\t\t\"data\": [\r\n\t\t\t\t\t\t\t\t35,\r\n\t\t\t\t\t\t\t\t8,\r\n\t\t\t\t\t\t\t\t25,\r\n\t\t\t\t\t\t\t\t37,\r\n\t\t\t\t\t\t\t\t4,\r\n\t\t\t\t\t\t\t\t20\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"name\": \"成交量B\",\r\n\t\t\t\t\t\t\t\"data\": [\r\n\t\t\t\t\t\t\t\t70,\r\n\t\t\t\t\t\t\t\t40,\r\n\t\t\t\t\t\t\t\t65,\r\n\t\t\t\t\t\t\t\t100,\r\n\t\t\t\t\t\t\t\t44,\r\n\t\t\t\t\t\t\t\t68\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\t// \t\tonLoad() {\r\n\r\n\r\n\t\t// \t\t\tthis.openBluetoothAdapterBefore(); //判断蓝牙适配器\r\n\r\n\t\t// \t\t\tthis.oneComponent = this.selectComponent('#mychart'); //曲线图\r\n\r\n\t\t// \t\t\tthis.getTeacherData(); //获取教师打球数据\r\n\r\n\t\t// \t\t\tthis.trainContent(); //查询目标拍次和训练拍次\r\n\r\n\r\n\t\t// \t\t},\r\n\t\t// \t\tonReady() {\r\n\r\n\t\t// \t\t\tconst query1 = uni.createSelectorQuery().in(this);\r\n\t\t// \t\t\tquery1.select('#id').boundingClientRect(data => {\r\n\t\t// \t\t\t\tconsole.log(\"得到布局位置信息\" + JSON.stringify(data));\r\n\t\t// \t\t\t\t// console.log(\"节点离页面顶部的距离为\" + data.top);\r\n\t\t// \t\t\t}).exec();\r\n\r\n\t\t// \t\t\t//获取webgl\r\n\t\t// \t\t\t/*  #ifndef   APP||H5   */\r\n\r\n\t\t// \t\t\t// wx.createSelectorQuery().select('#webgl').node().exec((res) => {\r\n\t\t// \t\t\tconst query = uni.createSelectorQuery().in(this)\r\n\t\t// \t\t\tquery.select('#webgl').node().exec((res) => {\r\n\t\t// \t\t\t\tconsole.log(\"res:\", res);\r\n\t\t// \t\t\t\tcanvas = res[0].node;\r\n\t\t// \t\t\t\tTHREE = createScopedThreejs(canvas);\r\n\r\n\t\t// \t\t\t\tcanvaWidth = 600;\r\n\t\t// \t\t\t\tcanvaHeight = 400;\r\n\t\t// \t\t\t\tthis.initCanva(canvas);\r\n\r\n\t\t// \t\t\t});\r\n\t\t// \t\t\t/*  #endif  */\r\n\r\n\r\n\r\n\r\n\t\t// \t\t},\r\n\t\t// \t\tmethods: {\r\n\r\n\t\t// \t\t\t/**\r\n\t\t// \t\t\t * 3d 初始化\r\n\t\t// \t\t\t * @param {*} canvas \r\n\t\t// \t\t\t */\r\n\t\t// \t\t\tinitCanva: function(canvas) {\r\n\t\t// \t\t\t\tflog = 0;\r\n\t\t// \t\t\t\taddYet = 0;\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tregisterGLTFLoader(THREE);\r\n\t\t// \t\t\t\t//scene\r\n\t\t// \t\t\t\tscene = new THREE.Scene();\r\n\r\n\t\t// \t\t\t\tcamera = new THREE.PerspectiveCamera(45, canvas.width / canvas.height, 1, 1000);\r\n\t\t// \t\t\t\tcamera.position.set(0, -125, 0); //设置相机的摆放位置\r\n\t\t// \t\t\t\tcamera.lookAt(new THREE.Vector3(0, 0, 0)); // 控制相机的焦点(镜头)位置，决定相机的朝向（取值为3维坐标对象-THREE.Vector3(x,y,z)）\r\n\t\t// \t\t\t\tcamera_parent = new THREE.Object3D(); //将相机放一个三维物体里\r\n\t\t// \t\t\t\tcamera_parent.position.set(0, 0, 0);\r\n\t\t// \t\t\t\tcamera_parent.add(camera);\r\n\t\t// \t\t\t\tscene.add(camera_parent);\r\n\r\n\r\n\t\t// \t\t\t\tvar geometry1 = new THREE.SphereGeometry(1, 32, 32);\r\n\t\t// \t\t\t\tvar material1 = new THREE.MeshBasicMaterial({\r\n\t\t// \t\t\t\t\tcolor: 0xffff00,\r\n\t\t// \t\t\t\t\ttransparent: true, //设置模型材质透明\r\n\t\t// \t\t\t\t\topacity: 0,\r\n\t\t// \t\t\t\t});\r\n\t\t// \t\t\t\tsphere1 = new THREE.Mesh(geometry1, material1);\r\n\t\t// \t\t\t\tsphere1.position.set(0, 0, -47);\r\n\r\n\t\t// \t\t\t\tcube2 = new THREE.Object3D(); //将点模型放一个cube里\r\n\t\t// \t\t\t\tcube2.position.set(0, 0, 0);\r\n\t\t// \t\t\t\tcube2.add(sphere1);\r\n\t\t// \t\t\t\tscene.add(cube2);\r\n\r\n\r\n\t\t// \t\t\t\t// model   \r\n\t\t// \t\t\t\tlet loader = new THREE.GLTFLoader(); //badminton.zip \r\n\t\t// \t\t\t\tloader.load('https://www.szearth.cn/SZearth/3D_Model/badminton.glb', function(gltf) {\r\n\r\n\t\t// \t\t\t\t\t\tlet model = gltf.scene;\r\n\r\n\t\t// \t\t\t\t\t\t//修改后\r\n\t\t// \t\t\t\t\t\tmodel.position.set(0, 0, -20);\r\n\t\t// \t\t\t\t\t\tcube = new THREE.Object3D();\r\n\t\t// \t\t\t\t\t\tcube.position.set(0, 0, 0);\r\n\t\t// \t\t\t\t\t\tcube.add(model);\r\n\r\n\t\t// \t\t\t\t\t\t// 设置球拍初始朝向\r\n\t\t// \t\t\t\t\t\tcube.rotateZ(-90 * a2h_dip);\r\n\t\t// \t\t\t\t\t\tcube.rotateZ(z_pi * a2h_dip);\r\n\t\t// \t\t\t\t\t\tcube.rotateY(x_pi * a2h_dip);\r\n\r\n\t\t// \t\t\t\t\t\t// 这里会出错，在加载模型同时，设置model为null，导致添加的模型为null\r\n\t\t// \t\t\t\t\t\tif (flog == 0 && addYet == 0) { //flog = 0 出现两次就会报错\r\n\t\t// \t\t\t\t\t\t\taddYet = 1;\r\n\t\t// \t\t\t\t\t\t\tscene.add(cube);\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfunction() {\r\n\t\t// \t\t\t\t\t\treturn pagestatus;\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tundefined,\r\n\t\t// \t\t\t\t\tfunction(e) {\r\n\t\t// \t\t\t\t\t\tconsole.error(\"加载模型出错：\", e);\r\n\t\t// \t\t\t\t\t});\r\n\r\n\r\n\t\t// \t\t\t\t//render\r\n\t\t// \t\t\t\trenderer = new THREE.WebGLRenderer({\r\n\t\t// \t\t\t\t\tantialias: true\r\n\t\t// \t\t\t\t});\r\n\t\t// \t\t\t\trenderer.setPixelRatio(2);\r\n\t\t// \t\t\t\trenderer.setSize(canvas.width, canvas.height);\r\n\r\n\t\t// \t\t\t\tthat.animate();\r\n\t\t// \t\t\t},\r\n\r\n\r\n\t\t// \t\t\tanimate: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tif (flog == 0) {\r\n\t\t// \t\t\t\t\tif (renderer !== null && scene !== null && camera !== null) {\r\n\t\t// \t\t\t\t\t\tif (cube != null) {\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\tif (app.globalData.isClick == true && this.isplayBack == false && app.globalData\r\n\t\t// \t\t\t\t\t\t\t\t.isCurrentSelectTripType == 'training') {\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\t\t//初始化固定，防止漂移。更新相关位置:度＝弧度×180°/π   默认顺序: \"XYZ\"\r\n\t\t// \t\t\t\t\t\t\t\tcube.rotation.set(0, 0, 0);\r\n\r\n\t\t// \t\t\t\t\t\t\t\t// 修改后\r\n\t\t// \t\t\t\t\t\t\t\tcube.rotateZ(-90 * a2h_dip);\r\n\t\t// \t\t\t\t\t\t\t\tcube.rotateZ(z_pi * a2h_dip);\r\n\t\t// \t\t\t\t\t\t\t\tcube.rotateY(x_pi * a2h_dip);\r\n\t\t// \t\t\t\t\t\t\t\tcube.rotateX(y_pi * a2h_dip);\r\n\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\tcanvas.requestAnimationFrame(that.animate);\r\n\t\t// \t\t\t\t\t\trenderer.render(scene, camera);\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t},\r\n\r\n\r\n\t\t// \t\t\t//移出threejs占用的资源\r\n\t\t// \t\t\tremove: function() { //remove只是移出父子关系，还要将其设置为null\r\n\t\t// \t\t\t\tflog = 1;\r\n\r\n\t\t// \t\t\t\tif (camera !== undefined && camera !== null) {\r\n\t\t// \t\t\t\t\tscene.remove(camera); //移出相机\r\n\t\t// \t\t\t\t\tcamera = null;\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t\tif (model != undefined && model !== null) {\r\n\t\t// \t\t\t\t\tscene.remove(model); //移出模型\r\n\t\t// \t\t\t\t\tmodel = null;\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t\tif (scene !== undefined && scene !== null) {\r\n\t\t// \t\t\t\t\tscene.dispose(); //注销场景\r\n\t\t// \t\t\t\t\tscene = null;\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\tif (renderer !== undefined && renderer !== null) {\r\n\t\t// \t\t\t\t\trenderer.dispose();\r\n\t\t// \t\t\t\t\trenderer = null;\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/** 蓝牙操作start */\r\n\r\n\t\t// \t\t\t//**打开蓝牙适配器前的操作 判断适配器是否关闭 */\r\n\t\t// \t\t\topenBluetoothAdapterBefore: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tif (!uni.openBluetoothAdapter) {\r\n\r\n\t\t// \t\t\t\t\tuni.showModal({\r\n\t\t// \t\t\t\t\t\ttitle: '提示',\r\n\t\t// \t\t\t\t\t\tshowCancel: false,\r\n\t\t// \t\t\t\t\t\tcontent: '当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。',\r\n\t\t// \t\t\t\t\t})\r\n\t\t// \t\t\t\t\treturn;\r\n\t\t// \t\t\t\t} else {\r\n\t\t// \t\t\t\t\tthat.openAdapter();\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/** 打开蓝牙适配器 */\r\n\t\t// \t\t\topenAdapter: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\r\n\t\t// \t\t\t\t// console.log(\"打开蓝牙适配器\");\r\n\r\n\t\t// \t\t\t\t// 初始化小程序蓝牙模块\r\n\t\t// \t\t\t\tuni.openBluetoothAdapter({\r\n\t\t// \t\t\t\t\tsuccess: (res) => {\r\n\t\t// \t\t\t\t\t\t// console.log(\"打开蓝牙适配器成功\");\r\n\t\t// \t\t\t\t\t\tthat.startBluetoothDevicesDiscovery();\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: (res) => {\r\n\r\n\t\t// \t\t\t\t\t\t// console.log(\"打开适配器失败:\", res, \" \", res.errCode);\r\n\r\n\t\t// \t\t\t\t\t\tif (res.state == 3) { //iOS 微信蓝牙未授权\r\n\t\t// \t\t\t\t\t\t\tlet timer = setTimeout(function() {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t// \t\t\t\t\t\t\t\t\ttitle: '请授权微信蓝牙',\r\n\t\t// \t\t\t\t\t\t\t\t\timage: '/static/images/index/bluet.png',\r\n\t\t// \t\t\t\t\t\t\t\t\tduration: 5000,\r\n\t\t// \t\t\t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t\t\t\tclearTimeout(timer);\r\n\t\t// \t\t\t\t\t\t\t}, 1000);\r\n\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\tif (res.errCode == 10001) {\r\n\r\n\t\t// \t\t\t\t\t\t\t// console.log(\"提示：\", res.errCode);\r\n\r\n\t\t// \t\t\t\t\t\t\tlet timer = setTimeout(function() {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t// \t\t\t\t\t\t\t\t\ttitle: '请开启手机蓝牙',\r\n\t\t// \t\t\t\t\t\t\t\t\timage: '/static/images/index/bluet.png',\r\n\t\t// \t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t// \t\t\t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t\t\t\tclearTimeout(timer);\r\n\t\t// \t\t\t\t\t\t\t}, 1000);\r\n\r\n\t\t// \t\t\t\t\t\t\t// 监听蓝牙适配器状态变化事件\r\n\t\t// \t\t\t\t\t\t\tuni.onBluetoothAdapterStateChange(function(res) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tif (res.available) {\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.openAdapter();\r\n\t\t// \t\t\t\t\t\t\t\t\tuni.offBluetoothAdapterStateChange(); //蓝牙适配器打开后，就关闭监听状态变化事件\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**开始搜寻附近的蓝牙外围设备 */\r\n\t\t// \t\t\tstartBluetoothDevicesDiscovery: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\r\n\r\n\t\t// \t\t\t\tuni.startBluetoothDevicesDiscovery({\r\n\r\n\t\t// \t\t\t\t\tallowDuplicatesKey: false,\r\n\t\t// \t\t\t\t\tsuccess: (res) => {\r\n\t\t// \t\t\t\t\t\t//提示信息\r\n\t\t// \t\t\t\t\t\tif (uni.getStorageSync('flog') == 1) {\r\n\r\n\t\t// \t\t\t\t\t\t\tlet timer = setTimeout(function() {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tuni.showLoading({\r\n\t\t// \t\t\t\t\t\t\t\t\ttitle: '搜索蓝牙...',\r\n\t\t// \t\t\t\t\t\t\t\t\tduration: 5000\r\n\t\t// \t\t\t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t\t\t\tclearTimeout(timer);\r\n\t\t// \t\t\t\t\t\t\t}, 100);\r\n\r\n\t\t// \t\t\t\t\t\t} else {\r\n\r\n\t\t// \t\t\t\t\t\t\tlet timer = setTimeout(function() {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tuni.showLoading({\r\n\t\t// \t\t\t\t\t\t\t\t\ttitle: '请打开活力π',\r\n\t\t// \t\t\t\t\t\t\t\t\tduration: 5000\r\n\t\t// \t\t\t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t\t\t\tclearTimeout(timer);\r\n\t\t// \t\t\t\t\t\t\t}, 100);\r\n\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\tthat.onBluetoothDeviceFound()\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: (res) => {\r\n\t\t// \t\t\t\t\t\t// console.log(\"搜索失败：\", res);\r\n\t\t// \t\t\t\t\t},\r\n\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\t\t// \t\t\t/**停止搜寻附近的蓝牙外围设备 */\r\n\t\t// \t\t\tstopBluetoothDevicesDiscovery: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tuni.stopBluetoothDevicesDiscovery({\r\n\t\t// \t\t\t\t\tsuccess: (res) => {\r\n\t\t// \t\t\t\t\t\t// console.log(\"停止搜索蓝牙成功：\", res)\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: (res) => {\r\n\t\t// \t\t\t\t\t\t// console.log(\"停止搜索蓝牙失败：\", res)\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\t\t// \t\t\t/** 监听寻找到新设备的事件 */\r\n\t\t// \t\t\tonBluetoothDeviceFound: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tlet devices = [];\r\n\t\t// \t\t\t\tlet item = [];\r\n\r\n\t\t// \t\t\t\t// console.log(\"监听寻找到新设备的事件\");\r\n\r\n\t\t// \t\t\t\tuni.onBluetoothDeviceFound((res) => {\r\n\r\n\t\t// \t\t\t\t\tres.devices.forEach(device => {\r\n\t\t// \t\t\t\t\t\tif (!device.name && !device.localName) {\r\n\t\t// \t\t\t\t\t\t\treturn\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\tconst foundDevices = devices\r\n\t\t// \t\t\t\t\t\tconst idx = that.inArray(foundDevices, 'deviceId', device.deviceId)\r\n\t\t// \t\t\t\t\t\tconst data = {}\r\n\r\n\t\t// \t\t\t\t\t\tif (idx === -1) {\r\n\r\n\t\t// \t\t\t\t\t\t\t// console.log(\"device:\", device);\r\n\t\t// \t\t\t\t\t\t\tdata[`devices[${foundDevices.length}]`] = device\r\n\t\t// \t\t\t\t\t\t\tlet ballType = device.localName.substring(0, 1);\r\n\r\n\t\t// \t\t\t\t\t\t\tif (ballType === 'Y') {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tlet len = item.length;\r\n\t\t// \t\t\t\t\t\t\t\t//存在多个芯片的情况下，选择信号强度最强的\r\n\t\t// \t\t\t\t\t\t\t\tif (len > 1) {\r\n\t\t// \t\t\t\t\t\t\t\t\t// 冒泡排序：按信号强弱排列，数值越小信号越强，由强及弱排\r\n\t\t// \t\t\t\t\t\t\t\t\tfor (let i = 0; i < len; i++) {\r\n\t\t// \t\t\t\t\t\t\t\t\t\tfor (let j = 0; j < len - 1 - i; j++) {\r\n\t\t// \t\t\t\t\t\t\t\t\t\t\tif (Math.abs(item[j].device_RSSI) > Math.abs(item[j + 1]\r\n\t\t// \t\t\t\t\t\t\t\t\t\t\t\t\t.device_RSSI)) {\r\n\t\t// \t\t\t\t\t\t\t\t\t\t\t\tlet temp = item[j + 1];\r\n\t\t// \t\t\t\t\t\t\t\t\t\t\t\titem[j + 1] = item[j];\r\n\t\t// \t\t\t\t\t\t\t\t\t\t\t\titem[j] = temp;\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\t\t\t\tthis.onBleDeviceFound(); //寻找已经添加的蓝牙设备  \r\n\r\n\t\t// \t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\t} else { //只有单个符合条件的芯片\r\n\t\t// \t\t\t\t\t\t\t\t\tthis.onBleDeviceFound(); //寻找已经添加的蓝牙设备\r\n\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t} else {\r\n\t\t// \t\t\t\t\t\t\tdata[`devices[${idx}]`] = device\r\n\t\t// \t\t\t\t\t\t\tlet ballType = device.localName.substring(0, 1);\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t})\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\r\n\t\t// \t\t\t/** 监听寻找到已添加的蓝牙设备*/\r\n\t\t// \t\t\tonBleDeviceFound: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\t// console.log(\"监听寻找到已添加的蓝牙设备\");\r\n\r\n\t\t// \t\t\t\tuni.getBluetoothDevices({\r\n\t\t// \t\t\t\t\tsuccess: function(res) {\r\n\r\n\t\t// \t\t\t\t\t\tlet devices = res.devices;\r\n\t\t// \t\t\t\t\t\tlet deviceIdCache = uni.getStorageSync(\"deviceIdCache\"); //获取缓存里的蓝牙设备id\r\n\t\t// \t\t\t\t\t\tlet deviceIndex = JSON.stringify(devices).indexOf(deviceIdCache);\r\n\r\n\t\t// \t\t\t\t\t\tif (deviceIndex >= 0 && deviceIdCache !== \"\" && deviceIdCache !== undefined) {\r\n\t\t// \t\t\t\t\t\t\tthat.connectBle(deviceIdCache);\r\n\t\t// \t\t\t\t\t\t\t// console.log(\"根据 deviceIdCache 连接\");\r\n\r\n\t\t// \t\t\t\t\t\t} else {\r\n\r\n\t\t// \t\t\t\t\t\t\tfor (let i = 0; i < devices.length; i++) {\r\n\t\t// \t\t\t\t\t\t\t\tlet ballType = devices[i].name.substring(0, 1);\r\n\t\t// \t\t\t\t\t\t\t\tif (ballType === 'Y') { //羽毛球\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\tif (that.connectStatus == false && that.connected == false) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\t\tthat.connected = true;\r\n\t\t// \t\t\t\t\t\t\t\t\t\tthat.connectBle(devices[i].deviceId);\r\n\t\t// \t\t\t\t\t\t\t\t\t\t// console.log(\"重新搜索连接\");\r\n\t\t// \t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: function(res) {\r\n\t\t// \t\t\t\t\t\t//console.log(\"搜索蓝牙设备失败\", res);\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t});\r\n\t\t// \t\t\t},\r\n\t\t// \t\t\t/**连接低功耗蓝牙设备 */\r\n\t\t// \t\t\tconnectBle: function(deviceId) {\r\n\t\t// \t\t\t\tlet that = this;\r\n\r\n\t\t// \t\t\t\tconst name = that.deviceName\r\n\t\t// \t\t\t\tuni.createBLEConnection({\r\n\t\t// \t\t\t\t\tdeviceId,\r\n\t\t// \t\t\t\t\ttimeout: 5000,\r\n\t\t// \t\t\t\t\tsuccess: function(res) {\r\n\r\n\t\t// \t\t\t\t\t\t// 连接成功，获取当前时间，用于每隔20毫秒，更新一次电量\r\n\t\t// \t\t\t\t\t\tconnTimestamp = Date.parse(new Date());\r\n\t\t// \t\t\t\t\t\tconnTimestamp = connTimestamp / 1000;\r\n\r\n\t\t// \t\t\t\t\t\t//查询位置信息\r\n\t\t// \t\t\t\t\t\tif (location === 0) {\r\n\t\t// \t\t\t\t\t\t\tthat.findlocation();\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\tshowErr = -1; //不设置为0的原因是，连接成功后，还会连接一次\r\n\r\n\t\t// \t\t\t\t\t\tuni.showToast({\r\n\t\t// \t\t\t\t\t\t\ttitle: '连接成功',\r\n\t\t// \t\t\t\t\t\t\ticon: 'success',\r\n\t\t// \t\t\t\t\t\t\tduration: 2000\r\n\t\t// \t\t\t\t\t\t})\r\n\r\n\r\n\t\t// \t\t\t\t\t\tthat.connectStatus = true;\r\n\t\t// \t\t\t\t\t\tthat.connected = false;\r\n\t\t// \t\t\t\t\t\tthat.name = name;\r\n\t\t// \t\t\t\t\t\tthat.deviceId = deviceId;\r\n\r\n\t\t// \t\t\t\t\t\tuni.setStorageSync('deviceIdCache', deviceId);\r\n\t\t// \t\t\t\t\t\tthat.onBleConnectState(); //监听蓝牙连接状态\r\n\t\t// \t\t\t\t\t\tthat.getBLEDeviceServices(deviceId); //获取蓝牙设备所有 service（服务）\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: function(res) {\r\n\t\t// \t\t\t\t\t\tshowErr = showErr + 1;\r\n\r\n\t\t// \t\t\t\t\t\t// console.log(\"连接失败\")\r\n\t\t// \t\t\t\t\t\tthat.connected = false;\r\n\r\n\t\t// \t\t\t\t\t\tif (res.errCode === 10003) {\r\n\t\t// \t\t\t\t\t\t\t//重新搜索后，再继续连接\r\n\t\t// \t\t\t\t\t\t\tif (showErr <= 1) {\r\n\t\t// \t\t\t\t\t\t\t\tif (isShowToast == true) {\r\n\t\t// \t\t\t\t\t\t\t\t\tuni.hideToast();\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t// \t\t\t\t\t\t\t\t\ttitle: '蓝牙连接异常',\r\n\t\t// \t\t\t\t\t\t\t\t\timage: '/static/images/index/bluet.png',\r\n\t\t// \t\t\t\t\t\t\t\t\tduration: 5000\r\n\t\t// \t\t\t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t\t\t\tisShowToast = true;\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\tthat.onBleDeviceFound() //获取已经添加的蓝牙设备\r\n\r\n\t\t// \t\t\t\t\t\t} else if (res.errCode === 10012) { //连接过程，低功耗蓝牙设备已关闭\r\n\r\n\t\t// \t\t\t\t\t\t\tif (showErr <= 1) {\r\n\t\t// \t\t\t\t\t\t\t\tif (isShowToast == true) {\r\n\t\t// \t\t\t\t\t\t\t\t\tuni.hideToast();\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t// \t\t\t\t\t\t\t\t\ttitle: '蓝牙连接异常',\r\n\t\t// \t\t\t\t\t\t\t\t\timage: '/static/images/index/bluet.png',\r\n\t\t// \t\t\t\t\t\t\t\t\tduration: 5000\r\n\t\t// \t\t\t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t\t\t\tisShowToast = true;\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\tthat.onBleDeviceFound(); //获取已经添加的蓝牙设备\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**@description 监听蓝牙连接状态 */\r\n\t\t// \t\t\tonBleConnectState: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tuni.onBLEConnectionStateChange(function(res) {\r\n\r\n\t\t// \t\t\t\t\tapp.globalData.bleConnectStatus = res.connected;\r\n\r\n\t\t// \t\t\t\t\tif (res.connected) {\r\n\t\t// \t\t\t\t\t\tthat.connectStatus = true;\r\n\t\t// \t\t\t\t\t} else {\r\n\t\t// \t\t\t\t\t\tthat.onBleDeviceFound(); //自动连接\r\n\t\t// \t\t\t\t\t\tthat.connectStatus = false;\r\n\r\n\t\t// \t\t\t\t\t\tx_pi = 180; //蓝牙断开连接后，模型位置复位\r\n\t\t// \t\t\t\t\t\ty_pi = 0;\r\n\t\t// \t\t\t\t\t\tz_pi = -90;\r\n\r\n\t\t// \t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**获取蓝牙设备所有 service（服务） */\r\n\t\t// \t\t\tgetBLEDeviceServices: function(deviceId) {\r\n\t\t// \t\t\t\tlet that = this;\r\n\r\n\t\t// \t\t\t\tuni.getBLEDeviceServices({\r\n\t\t// \t\t\t\t\tdeviceId,\r\n\t\t// \t\t\t\t\tsuccess: (res) => {\r\n\t\t// \t\t\t\t\t\t// console.log(\"获取蓝牙设备所有服务。。\", res)\r\n\t\t// \t\t\t\t\t\tfor (let i = 0; i < res.services.length; i++) {\r\n\t\t// \t\t\t\t\t\t\tlet uuid_slice = res.services[i].uuid.slice(4, 8);\r\n\t\t// \t\t\t\t\t\t\tif (uuid_slice != \"180A\" && uuid_slice != \"1800\" && uuid_slice != \"1801\" &&\r\n\t\t// \t\t\t\t\t\t\t\tuuid_slice != \"1802\") {\r\n\t\t// \t\t\t\t\t\t\t\tif (res.services[i].isPrimary) {\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.getBLEDeviceCharacteristics(deviceId, res.services[i].uuid)\r\n\t\t// \t\t\t\t\t\t\t\t\treturn\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**蓝牙设备characteristic(特征值)信息 */\r\n\t\t// \t\t\tgetBLEDeviceCharacteristics: function(deviceId, serviceId) {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tuni.getBLEDeviceCharacteristics({\r\n\t\t// \t\t\t\t\tdeviceId,\r\n\t\t// \t\t\t\t\tserviceId,\r\n\t\t// \t\t\t\t\tsuccess: (res) => {\r\n\r\n\t\t// \t\t\t\t\t\t// console.error('getBLEDeviceCharacteristics 成功', res);\r\n\r\n\t\t// \t\t\t\t\t\tfor (let i = 0; i < res.characteristics.length; i++) {\r\n\t\t// \t\t\t\t\t\t\tconst item = res.characteristics[i]\r\n\r\n\t\t// \t\t\t\t\t\t\tif (item.properties.read) {\r\n\t\t// \t\t\t\t\t\t\t\tuni.readBLECharacteristicValue({\r\n\t\t// \t\t\t\t\t\t\t\t\tdeviceId,\r\n\t\t// \t\t\t\t\t\t\t\t\tserviceId,\r\n\t\t// \t\t\t\t\t\t\t\t\tcharacteristicId: item.uuid,\r\n\t\t// \t\t\t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\tif (item.properties.write) {\r\n\t\t// \t\t\t\t\t\t\t\tif (item.uuid === '6E400002-B5A3-F393-E0A9-E50E24DCCA9E') {\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.deviceId = deviceId;\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.serviceId = serviceId;\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.writeCharacteristicId = item.uuid;\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\tif (item.properties.notify || item.properties.indicate) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tthat.deviceId = deviceId;\r\n\t\t// \t\t\t\t\t\t\t\tthat.serviceId = serviceId;\r\n\t\t// \t\t\t\t\t\t\t\tthat.characteristicId = item.uuid;\r\n\t\t// \t\t\t\t\t\t\t\tthat.openNotify()\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail(res) {\r\n\t\t// \t\t\t\t\t\tconsole.error('getBLEDeviceCharacteristics', res)\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/** 开启notify */\r\n\t\t// \t\t\topenNotify: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tconsole.log(\"that.deviceId:\", that.deviceId);\r\n\t\t// \t\t\t\tconsole.log(\"that.serviceId:\", that.serviceId);\r\n\t\t// \t\t\t\tconsole.log(\"that.characteristicId:\", that.characteristicId);\r\n\t\t// \t\t\t\tuni.notifyBLECharacteristicValueChange({\r\n\t\t// \t\t\t\t\tdeviceId: that.deviceId,\r\n\t\t// \t\t\t\t\tserviceId: that.serviceId,\r\n\t\t// \t\t\t\t\tcharacteristicId: that.characteristicId,\r\n\t\t// \t\t\t\t\tstate: true,\r\n\r\n\t\t// \t\t\t\t\tsuccess: function(res) {\r\n\r\n\t\t// \t\t\t\t\t\t// console.log(\"开启 notify 成功\", res);\r\n\r\n\t\t// \t\t\t\t\t\tthat.onBLECharacteristicValueChange(); //监听返回值变化\r\n\r\n\r\n\t\t// \t\t\t\t\t\t//获取当前时间戳  \r\n\t\t// \t\t\t\t\t\tlet timestamp = Date.parse(new Date());\r\n\t\t// \t\t\t\t\t\ttimestamp = timestamp / 1000;\r\n\r\n\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: function(res) {\r\n\t\t// \t\t\t\t\t\t// console.log(\"开启 notify 失败\", res);\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/** 监听返回值变化 */\r\n\t\t// \t\t\tonBLECharacteristicValueChange: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tuni.onBLECharacteristicValueChange(function(res) {\r\n\r\n\t\t// \t\t\t\t\t// console.log(\"onBLECharacteristicValueChange\", res);\r\n\t\t// \t\t\t\t\tthat.dataProcessing(res.value);\r\n\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**取消监听蓝牙连接状态 */\r\n\t\t// \t\t\toffBLEConnectionStateChange: function() {\r\n\t\t// \t\t\t\t//在退出页面时，取消监听\r\n\t\t// \t\t\t\tuni.offBLEConnectionStateChange({\r\n\t\t// \t\t\t\t\tsuccess: function() {\r\n\t\t// \t\t\t\t\t\t//console.log(\"取消监听成功：\", res)\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: function() {\r\n\t\t// \t\t\t\t\t\t//console.log(\"取消监听失败：\", res)\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**断开与低功耗蓝牙设备的连接 */\r\n\t\t// \t\t\tcloseBLEConnection: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\t// console.log(\"断开蓝牙\")\r\n\t\t// \t\t\t\tuni.closeBLEConnection({\r\n\t\t// \t\t\t\t\tdeviceId: that.deviceId,\r\n\t\t// \t\t\t\t\tsuccess: function(res) {\r\n\t\t// \t\t\t\t\t\t//console.log(\"断开蓝牙成功\", res)\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: function(res) {\r\n\t\t// \t\t\t\t\t\t// console.log(\"断开蓝牙失败\", res)\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tcomplete: function(res) {\r\n\t\t// \t\t\t\t\t\tthat.offBLEConnectionStateChange();\r\n\t\t// \t\t\t\t\t\tthat.closeBluetoothAdapter();\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**关闭蓝牙模块，使其进入未初始化状态。\r\n\t\t// \t\t\t * 调用该方法将断开所有已建立的链接并释放系统资源。建议在使用小程序蓝牙流程后调用 */\r\n\t\t// \t\t\tcloseBluetoothAdapter: function() {\r\n\t\t// \t\t\t\tuni.closeBluetoothAdapter({\r\n\t\t// \t\t\t\t\tsuccess: (res) => {\r\n\t\t// \t\t\t\t\t\t//console.log(\"关闭适配器成功：\", res)\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: (res) => {\r\n\t\t// \t\t\t\t\t\t//console.log(\"关闭适配器失败：\", res)\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**\r\n\t\t// \t\t\t *  向硬件发送命令\r\n\t\t// \t\t\t */\r\n\t\t// \t\t\tapp_send_to_device: function(cmd, values) {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\t// 向蓝牙设备发送一个0x00的16进制数据\r\n\t\t// \t\t\t\tlet buffer = new ArrayBuffer(16)\r\n\t\t// \t\t\t\tlet dataView = new DataView(buffer)\r\n\t\t// \t\t\t\tdataView.setUint8(0, cmd) //命令\r\n\t\t// \t\t\t\tdataView.setUint32(1, values) //向蓝牙发送命令参数\r\n\r\n\t\t// \t\t\t\tuni.writeBLECharacteristicValue({\r\n\r\n\t\t// \t\t\t\t\tdeviceId: that.deviceId,\r\n\t\t// \t\t\t\t\tserviceId: that.serviceId,\r\n\t\t// \t\t\t\t\tcharacteristicId: that.writeCharacteristicId,\r\n\t\t// \t\t\t\t\tvalue: buffer,\r\n\t\t// \t\t\t\t\tsuccess: function(res) {\r\n\t\t// \t\t\t\t\t\t//console.log('写入蓝牙特征值成功:', res.errMsg);\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t\tfail: function(res) {\r\n\t\t// \t\t\t\t\t\t//console.log('写入蓝牙特征值失败:', res.errMsg);\r\n\t\t// \t\t\t\t\t},\r\n\t\t// \t\t\t\t})\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\tinArray: function(arr, key, val) {\r\n\t\t// \t\t\t\tfor (let i = 0; i < arr.length; i++) {\r\n\t\t// \t\t\t\t\tif (arr[i][key] === val) {\r\n\t\t// \t\t\t\t\t\treturn i\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t\treturn -1\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/** 蓝牙操作end */\r\n\r\n\t\t// \t\t\tdataProcessing: function(data) {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tlet data_u8 = new Uint8Array(data);\r\n\t\t// \t\t\t\tlet cmd_type = data_u8[0]; //类型:type\r\n\t\t// \t\t\t\tlet time = data_u8[1]; //时间序号\r\n\r\n\t\t// \t\t\t\tvar timestamp = Date.parse(new Date());\r\n\t\t// \t\t\t\ttimestamp = timestamp / 1000;\r\n\r\n\t\t// \t\t\t\tif (timestamp - connTimestamp == 20 || typeof this.electric == 'undefined') {\r\n\r\n\r\n\t\t// \t\t\t\t\tthis.app_send_to_device(0xa6, 0x05); //手机发送心跳包，激活芯片倒计时 获取硬件电量\r\n\r\n\t\t// \t\t\t\t\tif (timestamp - connTimestamp == 20) {\r\n\t\t// \t\t\t\t\t\tconnTimestamp = timestamp;\r\n\t\t// \t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\tif (cmd_type == 0xa6) { //芯片的倒计时已激活，发送数据包\r\n\r\n\t\t// \t\t\t\t\tlet electric = data_u8[1]; //芯片电量\r\n\t\t// \t\t\t\t\telectric = parseInt(electric);\r\n\t\t// \t\t\t\t\t// console.log(\"electric:\", electric);\r\n\r\n\t\t// \t\t\t\t\tthis.electricShow = electric;\r\n\r\n\t\t// \t\t\t\t\telectric = parseInt(electric / 10);\r\n\r\n\r\n\t\t// \t\t\t\t\tif (electric >= 10) {\r\n\t\t// \t\t\t\t\t\telectric = 10;\r\n\r\n\t\t// \t\t\t\t\t\tthis.electric = electric;\r\n\r\n\t\t// \t\t\t\t\t} else if (electric <= 0) {\r\n\t\t// \t\t\t\t\t\telectric = 0;\r\n\t\t// \t\t\t\t\t} else {\r\n\r\n\t\t// \t\t\t\t\t\tthis.electric = electric;\r\n\t\t// \t\t\t\t\t}\r\n\r\n\r\n\t\t// \t\t\t\t\t// 提示用户充电\r\n\t\t// \t\t\t\t\tif (electric <= 1 && showCount !== 2) {\r\n\t\t// \t\t\t\t\t\tshowCount = 2;\r\n\t\t// \t\t\t\t\t\tlet value = '电量低于10%，请充电';\r\n\t\t// \t\t\t\t\t\t// that.start(value);\r\n\t\t// \t\t\t\t\t\tuni.showToast({\r\n\t\t// \t\t\t\t\t\t\ttitle: '电量低于10%，请充电',\r\n\t\t// \t\t\t\t\t\t\ticon: 'none',\r\n\t\t// \t\t\t\t\t\t\tduration: 2000\r\n\t\t// \t\t\t\t\t\t})\r\n\t\t// \t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\tlet axis = [];\r\n\r\n\t\t// \t\t\t\tlet data_int16_3d = new Int16Array(data);\r\n\r\n\t\t// \t\t\t\t//判断是训练模式时 可以绘制轨迹 currentSelectTripType 为 training 时 \r\n\t\t// \t\t\t\t//是学习模式时，清除页面上的轨迹，并让球拍回到最初的位置\r\n\t\t// \t\t\t\t// if (that.data.currentSelectTripType === 'training') {\r\n\r\n\t\t// \t\t\t\tif (this.currentSelectTripType == 'training') {\r\n\r\n\t\t// \t\t\t\t\tx_pi = data_int16_3d[1];\r\n\t\t// \t\t\t\t\ty_pi = data_int16_3d[2];\r\n\t\t// \t\t\t\t\tz_pi = data_int16_3d[3];\r\n\r\n\r\n\t\t// \t\t\t\t\t//矫正\r\n\t\t// \t\t\t\t\tif (zero_z == 0) {\r\n\t\t// \t\t\t\t\t\tlet dat = -90;\r\n\t\t// \t\t\t\t\t\tif (y_pi >= 90 || y_pi <= -90) dat = 90;\r\n\t\t// \t\t\t\t\t\tzero_z = z_pi + dat; //当前方向为北\r\n\t\t// \t\t\t\t\t}\r\n\t\t// \t\t\t\t\tz_pi -= zero_z; //校正方向\r\n\r\n\r\n\t\t// \t\t\t\t\t//使用队列保存 cmd_type 判断是开始挥拍，就移除线\r\n\t\t// \t\t\t\t\tif (cmd_type == 5 || cmd_type == 6) {\r\n\t\t// \t\t\t\t\t\tarr1.push(cmd_type);\r\n\t\t// \t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\tif (arr1.length > 3) {\r\n\t\t// \t\t\t\t\t\tarr1.shift(arr1[0] - 1); //长度大于3 移除第一个\r\n\t\t// \t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\tif (arr1.length >= 3) {\r\n\r\n\t\t// \t\t\t\t\t\t//前一次命令是 6 后一次命令是5 说明挥拍结束\r\n\t\t// \t\t\t\t\t\tif (arr1[0] == 6 && arr1[1] == 6 && arr1[2] == 5) {\r\n\r\n\t\t// \t\t\t\t\t\t\tvar timestamp = Date.parse(new Date());\r\n\t\t// \t\t\t\t\t\t\ttimeEnd = timestamp / 1000;\r\n\r\n\t\t// \t\t\t\t\t\t\t// 找到速度最大的航向角，之后每一次都减去此值\r\n\t\t// \t\t\t\t\t\t\tadjustAngle = 0;\r\n\r\n\t\t// \t\t\t\t\t\t\t//标识当前是挥拍过程 用于在挥拍过程点击画布 不显示回放面\r\n\t\t// \t\t\t\t\t\t\tthat.swing = 0; //挥拍\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\t// if (that.data.bEnd == false) { //点击开始按钮 \r\n\t\t// \t\t\t\t\t\t\tif (app.globalData.isClick == false) { //点击开始按钮\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\t\t// 计算当前动作速度\r\n\t\t// \t\t\t\t\t\t\t\tconsole.log(\"accData:\", accData);\r\n\r\n\t\t// \t\t\t\t\t\t\t\tfor (let i = 0; i < accData.length; i++) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\tlet accX = accData[i].x;\r\n\t\t// \t\t\t\t\t\t\t\t\tlet accY = accData[i].y;\r\n\t\t// \t\t\t\t\t\t\t\t\tlet accZ = accData[i].z;\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\t// 计算速度\r\n\t\t// \t\t\t\t\t\t\t\t\tlet speedAcc = Math.abs(accX + accY + accZ);\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\tif (speedAcc > speedMin) {\r\n\t\t// \t\t\t\t\t\t\t\t\t\ttotal = total + 1;\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t\tthat.playtrackDraw(ahrsData, true); // 挥拍结束，网格 \r\n\r\n\t\t// \t\t\t\t\t\t\t\tlet lenTeacher = app.globalData.lenTeacher;\r\n\r\n\t\t// \t\t\t\t\t\t\t\tconsole.log(\"total:\", total);\r\n\t\t// \t\t\t\t\t\t\t\tconsole.log(\"lenTeacher:\", lenTeacher);\r\n\t\t// \t\t\t\t\t\t\t\tconsole.log(\"intervalTime:\", intervalTime);\r\n\t\t// \t\t\t\t\t\t\t\t// if (total >= lenTeacher * shieldMin && total <= lenTeacher * shieldMax) {\r\n\t\t// \t\t\t\t\t\t\t\tif (total >= lenTeacher * shieldMin && total <= lenTeacher * shieldMax &&\r\n\t\t// \t\t\t\t\t\t\t\t\tintervalTime > 1) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.playtrackDraw(ahrsData, true); // 挥拍结束，网格 \r\n\t\t// \t\t\t\t\t\t\t\t} else {\r\n\t\t// \t\t\t\t\t\t\t\t\t// 提示动作不规范\r\n\t\t// \t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t// \t\t\t\t\t\t\t\t\t\ttitle: '动作不规范，请重新挥拍',\r\n\t\t// \t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t// \t\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t// \t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t\tconsole.log(\"最后 total：\", total, \" lenMin:\", lenTeacher * shieldMin, \" lenMax:\",\r\n\t\t// \t\t\t\t\t\t\t\t\tlenTeacher * shieldMax, \" len:\", lenTeacher, \" 总长度：\", accData.length);\r\n\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t//前一次命令是 5 后一次命令是6 说明开始挥拍\r\n\t\t// \t\t\t\t\t\tif (arr1[0] == 5 && arr1[1] == 5 && arr1[2] == 6) {\r\n\r\n\t\t// \t\t\t\t\t\t\tvar timestamp = Date.parse(new Date());\r\n\t\t// \t\t\t\t\t\t\ttimeStart = timestamp / 1000;\r\n\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"timeStart:\", timeStart);\r\n\r\n\t\t// \t\t\t\t\t\t\tintervalTime = timeStart - timeEnd;\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"intervalTime:\", intervalTime);\r\n\r\n\t\t// \t\t\t\t\t\t\tadjustAngle = z_pi;\r\n\r\n\t\t// \t\t\t\t\t\t\tahrsData = [];\r\n\t\t// \t\t\t\t\t\t\tnum = 0;\r\n\r\n\t\t// \t\t\t\t\t\t\t//标识当前是挥拍过程 用于在挥拍过程点击画布 不显示回放面\r\n\t\t// \t\t\t\t\t\t\tthat.swing = 1;\r\n\r\n\t\t// \t\t\t\t\t\t\tlet beforTime = Date.parse(new Date());\r\n\t\t// \t\t\t\t\t\t\tlet beTime = util.formatTime(beforTime); //时间戳转时间\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\t// 清除学习模式和训练模式底部 轨迹\r\n\t\t// \t\t\t\t\t\t\tfor (let j = 0; j < mainlineArryGet.length; j++) {\r\n\t\t// \t\t\t\t\t\t\t\tscene.remove(mainlineArryGet[j]);\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t// 清除训练模式 挥拍轨迹\r\n\t\t// \t\t\t\t\t\t\tfor (let j = 0; j < mainlineArry.length; j++) {\r\n\t\t// \t\t\t\t\t\t\t\tscene.remove(mainlineArry[j]);\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t// if (num >= dataCount) {\r\n\t\t// \t\t\t\t\t\t\t//   //清除面 \r\n\t\t// \t\t\t\t\t\t\t//   for (let j = 0; j < mainlineArry.length; j++) {\r\n\t\t// \t\t\t\t\t\t\t//     scene.remove(mainlineArry[j]);\r\n\t\t// \t\t\t\t\t\t\t//   }\r\n\r\n\t\t// \t\t\t\t\t\t\t//   //有轨迹面数据 \r\n\t\t// \t\t\t\t\t\t\t//   for (let j = 0; j < mainlineArryGet.length; j++) {\r\n\t\t// \t\t\t\t\t\t\t//     scene.remove(mainlineArryGet[j]);\r\n\t\t// \t\t\t\t\t\t\t//   }\r\n\r\n\t\t// \t\t\t\t\t\t\t// }\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\tlet afterTime = Date.parse(new Date());\r\n\t\t// \t\t\t\t\t\t\tlet afTime = util.formatTime(afterTime); //时间戳转时间\r\n\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t}\r\n\r\n\r\n\t\t// \t\t\t\t\tif (cmd_type == 6) { //<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<实时姿态数据包\r\n\r\n\t\t// \t\t\t\t\t\tlet data_int16 = new Int16Array(data);\r\n\r\n\t\t// \t\t\t\t\t\t//3轴欧拉角\r\n\t\t// \t\t\t\t\t\tlet ahrs_x = data_int16[1];\r\n\t\t// \t\t\t\t\t\tlet ahrs_y = data_int16[2];\r\n\t\t// \t\t\t\t\t\tlet ahrs_z = data_int16[3];\r\n\t\t// \t\t\t\t\t\tahrs_z = ahrs_z - Math.abs(adjustAngle);\r\n\r\n\t\t// \t\t\t\t\t\tlet ahrsArray = {\r\n\t\t// \t\t\t\t\t\t\t\"x\": ahrs_x,\r\n\t\t// \t\t\t\t\t\t\t\"y\": ahrs_y,\r\n\t\t// \t\t\t\t\t\t\t\"z\": ahrs_z\r\n\t\t// \t\t\t\t\t\t};\r\n\r\n\t\t// \t\t\t\t\t\t//3轴转速度\r\n\t\t// \t\t\t\t\t\tlet gyro_x = data_int16[4];\r\n\t\t// \t\t\t\t\t\tlet gyro_y = data_int16[5];\r\n\t\t// \t\t\t\t\t\tlet gyro_z = data_int16[6];\r\n\t\t// \t\t\t\t\t\tlet gyroArray = {\r\n\t\t// \t\t\t\t\t\t\t\"x\": gyro_x,\r\n\t\t// \t\t\t\t\t\t\t\"y\": gyro_y,\r\n\t\t// \t\t\t\t\t\t\t\"z\": gyro_z\r\n\t\t// \t\t\t\t\t\t};\r\n\r\n\r\n\r\n\t\t// \t\t\t\t\t\t//3轴加速度\r\n\t\t// \t\t\t\t\t\tlet acc_x = data_int16[7];\r\n\t\t// \t\t\t\t\t\tlet acc_y = data_int16[8];\r\n\t\t// \t\t\t\t\t\tlet acc_z = data_int16[9];\r\n\t\t// \t\t\t\t\t\tlet accArray = {\r\n\t\t// \t\t\t\t\t\t\t\"x\": acc_x,\r\n\t\t// \t\t\t\t\t\t\t\"y\": acc_y,\r\n\t\t// \t\t\t\t\t\t\t\"z\": acc_z\r\n\t\t// \t\t\t\t\t\t};\r\n\r\n\t\t// \t\t\t\t\t\tahrsData.push(ahrsArray); //保存欧拉角的值\r\n\t\t// \t\t\t\t\t\taccData.push(accArray); //保存加速度的值\r\n\t\t// \t\t\t\t\t\tgyroData.push(gyroArray); //保存转速度的值\r\n\r\n\t\t// \t\t\t\t\t\taxis.push(\"\");\r\n\r\n\t\t// \t\t\t\t\t\t//存数据\r\n\t\t// \t\t\t\t\t\tnum++;\r\n\r\n\t\t// \t\t\t\t\t\t//使用 gyroArray 转速度的值，去画曲线（3轴转速度相加的绝对值）;\r\n\t\t// \t\t\t\t\t\t// curveData = Math.abs(gyro_x + gyro_y + gyro_z);\r\n\r\n\t\t// \t\t\t\t\t\t// if (curveArray.length == 0) {\r\n\t\t// \t\t\t\t\t\t//   curveArray.push(0);\r\n\t\t// \t\t\t\t\t\t// }\r\n\t\t// \t\t\t\t\t\t// curveArray.push(curveData);\r\n\r\n\r\n\t\t// \t\t\t\t\t} else if (cmd_type == 5) {\r\n\r\n\r\n\t\t// \t\t\t\t\t\tlet lenTeacher = app.globalData.lenTeacher;\r\n\r\n\r\n\t\t// \t\t\t\t\t\t//上传数据到服务器 \r\n\t\t// \t\t\t\t\t\t// if (num >= dataCount && app.data.isClick == false && total >= lenTeacher * shieldMin && total <= lenTeacher * shieldMax) {\r\n\r\n\t\t// \t\t\t\t\t\t// if (app.data.isClick == false && total >= lenTeacher * shieldMin && total <= lenTeacher * shieldMax) {\r\n\t\t// \t\t\t\t\t\tif (app.globalData.isClick == false && total >= lenTeacher * shieldMin && total <= lenTeacher *\r\n\t\t// \t\t\t\t\t\t\tshieldMax && intervalTime > 1) {\r\n\r\n\t\t// \t\t\t\t\t\t\tintervalTime = 0;\r\n\r\n\t\t// \t\t\t\t\t\t\t//点击开始后，才设置拍次 train_count\r\n\t\t// \t\t\t\t\t\t\t// if (that.data.bEnd == false) {\r\n\t\t// \t\t\t\t\t\t\tif (app.globalData.isClick == false) {\r\n\t\t// \t\t\t\t\t\t\t\tlet train_count = that.train_count;\r\n\t\t// \t\t\t\t\t\t\t\ttrain_count = train_count + 1;\r\n\t\t// \t\t\t\t\t\t\t\tthat.train_count = train_count;\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\tlet similarityValue = 0;\r\n\r\n\t\t// \t\t\t\t\t\t\tlet xsd_result = 0;\r\n\t\t// \t\t\t\t\t\t\tlet score = xsd_result; //成绩得分\r\n\t\t// \t\t\t\t\t\t\tif (JSON.stringify(teacherData).length > 0) {\r\n\t\t// \t\t\t\t\t\t\t\tlet tpldata = ahrsData; //学员现在数据\r\n\t\t// \t\t\t\t\t\t\t\tlet tardata = JSON.parse(teacherData.ahrs); //教师端数据\r\n\t\t// \t\t\t\t\t\t\t\txsd_result = com_2d.analysis(tpldata, tardata);\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\t\tsimilarityValue = xsd_result;\r\n\t\t// \t\t\t\t\t\t\t\txsd_result = (parseFloat(xsd_result) * 100).toFixed(0);\r\n\t\t// \t\t\t\t\t\t\t\tscore = similarityValue;\r\n\r\n\t\t// \t\t\t\t\t\t\t\tthat.similarityOld = xsd_result + '%';\r\n\t\t// \t\t\t\t\t\t\t\tif (similarityValue >= 100) {\r\n\t\t// \t\t\t\t\t\t\t\t\tscore = 100;\r\n\t\t// \t\t\t\t\t\t\t\t\tsimilarityValue = 100;\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.similarity = '100%';\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.similarityOld = '100%';\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t//列表展示 添加到页面上\r\n\t\t// \t\t\t\t\t\t\tlet nowTime = new Date(new Date);\r\n\t\t// \t\t\t\t\t\t\tnowTime = util.formatTime(nowTime); //时间戳转时间\r\n\t\t// \t\t\t\t\t\t\tlet index = nowTime.indexOf(':');\r\n\t\t// \t\t\t\t\t\t\tnowTime = nowTime.substring(index - 2, index + 3);\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\tlet getId = 0;\r\n\t\t// \t\t\t\t\t\t\tif (listValue.length > 0) {\r\n\t\t// \t\t\t\t\t\t\t\tgetId = listValue[0].id + 1;\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\tlet nowData = {\r\n\t\t// \t\t\t\t\t\t\t\t// \"id\": 0,// 添加id\r\n\t\t// \t\t\t\t\t\t\t\t\"id\": getId, // 添加id\r\n\t\t// \t\t\t\t\t\t\t\t\"time\": nowTime,\r\n\t\t// \t\t\t\t\t\t\t\t\"similarity\": xsd_result,\r\n\t\t// \t\t\t\t\t\t\t\t// \"similarity\": similarityValue,\r\n\t\t// \t\t\t\t\t\t\t\t\"ahrs\": JSON.stringify(ahrsData),\r\n\t\t// \t\t\t\t\t\t\t\t\"gyro\": JSON.stringify(gyroData),\r\n\t\t// \t\t\t\t\t\t\t};\r\n\r\n\t\t// \t\t\t\t\t\t\t//使用 gyroArray 转速度的值，去画曲线（3轴转速度相加的绝对值）;\r\n\t\t// \t\t\t\t\t\t\tfor (let i = 0; i < gyroData.length; i++) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tlet curveData = Math.abs(gyroData[i].x + gyroData[i].y + gyroData[i].z);\r\n\t\t// \t\t\t\t\t\t\t\tif (curveArray.length == 0) {\r\n\t\t// \t\t\t\t\t\t\t\t\tcurveArray.push(0);\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\tcurveArray.push(curveData);\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"教师 前 curveTeach:\", curveTeach, \" 长度：\", curveTeach.length);\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"学生 前 curveArray:\", curveArray, \" 长度：\", curveArray.length);\r\n\r\n\t\t// \t\t\t\t\t\t\tformat.formatData(curveTeach, curveArray);\r\n\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"教师 curveTeach:\", curveTeach, \" 长度：\", curveTeach.length);\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"学生 curveArray:\", curveArray, \" 长度：\", curveArray.length);\r\n\r\n\t\t// \t\t\t\t\t\t\t/** 计算发力曲线相似度 start */\r\n\t\t// \t\t\t\t\t\t\t// 取最高点后的最低点作为结束点 \r\n\t\t// \t\t\t\t\t\t\tlet indexMax = 0; //最大值\r\n\t\t// \t\t\t\t\t\t\tlet indexMin = 0; //最大值后的最小值\r\n\t\t// \t\t\t\t\t\t\tlet getIndex = 0; //取的下标\r\n\t\t// \t\t\t\t\t\t\tlet start = 0; //数组开始下标\r\n\t\t// \t\t\t\t\t\t\tlet end = curveArray.length; //数组结束下标\r\n\t\t// \t\t\t\t\t\t\tlet newCurveArray = curveArray;\r\n\t\t// \t\t\t\t\t\t\tif (curveArray.length > curveTeach.length) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tfor (let i = 0; i < curveArray.length; i++) {\r\n\t\t// \t\t\t\t\t\t\t\t\tif (curveArray[indexMax] < curveArray[i]) {\r\n\t\t// \t\t\t\t\t\t\t\t\t\tindexMax = i;\r\n\t\t// \t\t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t\tindexMin = indexMax;\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\t\tfor (let i = 0; i < curveArray.length; i++) {\r\n\t\t// \t\t\t\t\t\t\t\t\tif (i > indexMax) {\r\n\t\t// \t\t\t\t\t\t\t\t\t\tif (curveArray[indexMin] > curveArray[i]) {\r\n\t\t// \t\t\t\t\t\t\t\t\t\t\tindexMin = i;\r\n\t\t// \t\t\t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\t\tgetIndex = indexMin + 4;\r\n\r\n\t\t// \t\t\t\t\t\t\t\t// 计算结束下标 当大于标准长度时\r\n\t\t// \t\t\t\t\t\t\t\tif (getIndex >= curveTeach.length) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\t// 判断获取的 getIndex 是否大于 curveArray 长度\r\n\t\t// \t\t\t\t\t\t\t\t\tif (getIndex < curveArray.length) {\r\n\t\t// \t\t\t\t\t\t\t\t\t\tend = getIndex;\r\n\t\t// \t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\t// 计算开始下标\r\n\t\t// \t\t\t\t\t\t\t\t\tstart = end - curveTeach.length;\r\n\t\t// \t\t\t\t\t\t\t\t} else {\r\n\t\t// \t\t\t\t\t\t\t\t\tend = curveTeach.length;\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t\tconsole.log(\"start:\", start, \" end:\", end);\r\n\t\t// \t\t\t\t\t\t\t\t// 学生数组取值\r\n\t\t// \t\t\t\t\t\t\t\tnewCurveArray = curveArray.slice(start, end + 1);\r\n\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\tvar xsd = com_2d.analysisSpeed(curveTeach, newCurveArray);\r\n\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"发力曲线相似度:\", xsd);\r\n\r\n\t\t// \t\t\t\t\t\t\tthat.similarity = (parseFloat(xsd) * 100).toFixed(0) + '%'; //页面显示发力曲线相似度\r\n\t\t// \t\t\t\t\t\t\t/** 计算发力曲线相似度 end */\r\n\r\n\t\t// \t\t\t\t\t\t\t/** 余弦相似性 */\r\n\t\t// \t\t\t\t\t\t\tlet cosXsd = cos.coSimilarity(curveTeach, curveArray);\r\n\r\n\t\t// \t\t\t\t\t\t\tthat.cosXsd = (parseFloat(cosXsd) * 100).toFixed(0) + '%';\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"cosXsd:\", cosXsd);\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\tconsole.log(\"挥拍时绘制:\", curveArray);\r\n\r\n\t\t// \t\t\t\t\t\t\t//  绘制发力曲线 绘制\r\n\t\t// \t\t\t\t\t\t\tthat.initGraph(curveTeach, curveArray, axisTeacher, false);\r\n\t\t// \t\t\t\t\t\t\tcurveArray = []; //清除转速度数组（发力曲线）\r\n\t\t// \t\t\t\t\t\t\taxis = [];\r\n\r\n\t\t// \t\t\t\t\t\t\tlistValue.unshift(nowData); //在数组前插入数据\r\n\r\n\t\t// \t\t\t\t\t\t\tlet number = listValue.length;\r\n\t\t// \t\t\t\t\t\t\tlistValue[0].number = number; //添加序号\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\t// console.log(\"添加时 listValue：\", listValue);\r\n\r\n\t\t// \t\t\t\t\t\t\tfrequency = frequency + 1;\r\n\t\t// \t\t\t\t\t\t\tthat.lists = listValue;\r\n\t\t// \t\t\t\t\t\t\tthat.frequency = frequency;\r\n\r\n\r\n\t\t// \t\t\t\t\t\t\tlet listOne = {\r\n\t\t// \t\t\t\t\t\t\t\t\"ahrs\": JSON.stringify(ahrsData),\r\n\t\t// \t\t\t\t\t\t\t\t\"gyro\": JSON.stringify(gyroData),\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\tbackArr.unshift(listOne); //在数组前插入数据\r\n\r\n\t\t// \t\t\t\t\t\t\t// console.log(\"添加时 backArr:\", backArr);\r\n\r\n\t\t// \t\t\t\t\t\t\tlet ball = {\r\n\t\t// \t\t\t\t\t\t\t\t\"ahrs\": ahrsData,\r\n\t\t// \t\t\t\t\t\t\t\t\"gyro\": gyroData,\r\n\t\t// \t\t\t\t\t\t\t\t\"acc\": accData,\r\n\t\t// \t\t\t\t\t\t\t\t\"score\": score, //成绩得分\r\n\t\t// \t\t\t\t\t\t\t\t\"time\": Date.parse(new Date()), //挥拍/击球时刻\r\n\t\t// \t\t\t\t\t\t\t\t\"similarity\": xsd_result, //相似度 \r\n\t\t// \t\t\t\t\t\t\t\t// \"similarity\": similarityValue, //相似度 \r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\tyqData = uni.getStorageSync(\"yqData\"); //将数据存入本地\r\n\r\n\t\t// \t\t\t\t\t\t\tif (yqData == \"\") {\r\n\t\t// \t\t\t\t\t\t\t\tyqData = [];\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\tyqData.push(ball);\r\n\t\t// \t\t\t\t\t\t\tuni.setStorageSync('yqData', yqData); //缓存到小程序\r\n\r\n\t\t// \t\t\t\t\t\t\t//调用上传数据 每满五次后，就上传数据\r\n\t\t// \t\t\t\t\t\t\tif (yqData.length >= 5) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tlet that = this;\r\n\t\t// \t\t\t\t\t\t\t\tlet url = \"a\";\r\n\r\n\t\t// \t\t\t\t\t\t\t\tlet params = {\r\n\t\t// \t\t\t\t\t\t\t\t\t\"course_id\": courseId, //课程id\r\n\t\t// \t\t\t\t\t\t\t\t\t\"content_id\": contentId, //课程内容id\r\n\t\t// \t\t\t\t\t\t\t\t\t'openid': openId,\r\n\t\t// \t\t\t\t\t\t\t\t\t\"startTime\": startTime,\r\n\t\t// \t\t\t\t\t\t\t\t\t\"list\": yqData,\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\t\tlet field = http.verify(\"30110140\", params);\r\n\r\n\t\t// \t\t\t\t\t\t\t\thttp.request(url, \"POST\", field).then(function(res) {\r\n\t\t// \t\t\t\t\t\t\t\t\t// 上传完成后清空缓存\r\n\t\t// \t\t\t\t\t\t\t\t\tuni.removeStorageSync(\"yqData\");\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\tlet dateTime = util.formatTime(Date.parse(new Date())).substring(0, 10);\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.date = dateTime;\r\n\t\t// \t\t\t\t\t\t\t\t\tthat.querySimilarity(dateTime); //五拍上传一次，重新查询相似度等数据\r\n\r\n\t\t// \t\t\t\t\t\t\t\t});\r\n\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\tgyroData = [];\r\n\t\t// \t\t\t\t\t\taccData = [];\r\n\t\t// \t\t\t\t\t\ttotal = 0;\r\n\r\n\t\t// \t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t},\r\n\r\n\r\n\t\t// \t\t\t// 回放轨迹主体部分 训练模式 挥拍\r\n\t\t// \t\t\tplaytrackDraw: function(data, isWireframe) {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tlet pointListBack = [];\r\n\t\t// \t\t\t\tlet tag = 1;\r\n\r\n\t\t// \t\t\t\tthat.isplayBack = true;\r\n\r\n\t\t// \t\t\t\t//清除回放的轨迹面 或者网格\r\n\t\t// \t\t\t\tfor (let j = 0; j < mainlineArryGet.length; j++) {\r\n\t\t// \t\t\t\t\tscene.remove(mainlineArryGet[j]);\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\t//清除回放的轨迹面 或者网格\r\n\t\t// \t\t\t\tfor (let j = 0; j < mainlineArry.length; j++) {\r\n\t\t// \t\t\t\t\tscene.remove(mainlineArry[j]);\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\t// 拿到教练打球动作进行回放\r\n\t\t// \t\t\t\tfor (let i = 0; i < data.length; i++) {\r\n\r\n\t\t// \t\t\t\t\tlet timer = setTimeout(function(pointj, len) {\r\n\t\t// \t\t\t\t\t\tlet x_pi = pointj.x;\r\n\t\t// \t\t\t\t\t\tlet y_pi = pointj.y;\r\n\t\t// \t\t\t\t\t\tlet z_pi = pointj.z;\r\n\r\n\t\t// \t\t\t\t\t\tcube.rotation.set(0, 0, 0);\r\n\t\t// \t\t\t\t\t\t//模型回放\r\n\t\t// \t\t\t\t\t\tcube.rotateZ(-90 * a2h_dip);\r\n\t\t// \t\t\t\t\t\tcube.rotateZ(z_pi * a2h_dip);\r\n\t\t// \t\t\t\t\t\tcube.rotateY(x_pi * a2h_dip);\r\n\t\t// \t\t\t\t\t\tcube.rotateX(y_pi * a2h_dip);\r\n\r\n\t\t// \t\t\t\t\t\tif (cube2 != null) {\r\n\r\n\t\t// \t\t\t\t\t\t\tcube2.rotation.copy(cube.rotation);\r\n\r\n\t\t// \t\t\t\t\t\t\tpointListBack.push(sphere1.getWorldPosition());\r\n\t\t// \t\t\t\t\t\t\tif (pointListBack[0].x == 0 && pointListBack[0].z == -47) {\r\n\t\t// \t\t\t\t\t\t\t\tpointListBack.shift();\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t// 去掉跟上一次绘制结束位置 会连起来绘制的点\r\n\t\t// \t\t\t\t\t\t\tif (tag == 1) {\r\n\t\t// \t\t\t\t\t\t\t\tpointListBack.shift();\r\n\t\t// \t\t\t\t\t\t\t\ttag = 2;\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t// 数组保留两个值 用于绘制轨迹网格或面\r\n\t\t// \t\t\t\t\t\t\tif (pointListBack.length > 2) {\r\n\t\t// \t\t\t\t\t\t\t\tpointListBack.shift();\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t\tif (pointListBack.length >= 2) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\tvar geometry = new THREE.BufferGeometry(); //声明一个缓冲几何体对象\r\n\r\n\t\t// \t\t\t\t\t\t\t\tlet vector = [];\r\n\t\t// \t\t\t\t\t\t\t\tvector.push(0, 0, 0);\r\n\t\t// \t\t\t\t\t\t\t\tvector.push(pointListBack[0].x, pointListBack[0].y, pointListBack[0].z);\r\n\t\t// \t\t\t\t\t\t\t\tvector.push(pointListBack[1].x, pointListBack[1].y, pointListBack[1].z);\r\n\r\n\t\t// \t\t\t\t\t\t\t\tvar vertices = new Float32Array(vector);\r\n\t\t// \t\t\t\t\t\t\t\t// 创建属性缓冲区对象\r\n\t\t// \t\t\t\t\t\t\t\tvar attribue = new THREE.BufferAttribute(vertices, 3); //3个为一组，作为一个顶点的xyz坐标\r\n\t\t// \t\t\t\t\t\t\t\t// 设置几何体attributes属性的位置position属性\r\n\t\t// \t\t\t\t\t\t\t\tgeometry.attributes.position = attribue;\r\n\r\n\t\t// \t\t\t\t\t\t\t\t//类型数组创建顶点颜色color数据 取值是 0-1\r\n\t\t// \t\t\t\t\t\t\t\tvar colors = new Float32Array([\r\n\t\t// \t\t\t\t\t\t\t\t\t0.12, 0.6, 1, //顶点3颜色\r\n\t\t// \t\t\t\t\t\t\t\t\t0.40, 0.87,\r\n\t\t// \t\t\t\t\t\t\t\t\t0.81, //顶点1颜色 （球拍底部） （176,225,250 将1设置成255 比如176/255=0.69）\r\n\t\t// \t\t\t\t\t\t\t\t\t0.40, 0.87, 0.81, //顶点2颜色 （251,240,234）\r\n\t\t// \t\t\t\t\t\t\t\t]);\r\n\r\n\t\t// \t\t\t\t\t\t\t\t// 设置几何体attributes属性的颜色color属性\r\n\t\t// \t\t\t\t\t\t\t\tgeometry.attributes.color = new THREE.BufferAttribute(colors,\r\n\t\t// \t\t\t\t\t\t\t\t\t3); //3个为一组,表示一个顶点的颜色数据RGB\r\n\r\n\t\t// \t\t\t\t\t\t\t\tvar meshMaterial = new THREE.MeshBasicMaterial({\r\n\t\t// \t\t\t\t\t\t\t\t\tside: THREE.DoubleSide, //避免部分面，不显示出来\r\n\t\t// \t\t\t\t\t\t\t\t\tvertexColors: THREE.VertexColors, //以顶点颜色为准\r\n\t\t// \t\t\t\t\t\t\t\t\twireframe: isWireframe, //设置网格 \r\n\t\t// \t\t\t\t\t\t\t\t});\r\n\r\n\t\t// \t\t\t\t\t\t\t\tlet mesh = new THREE.Mesh(geometry, meshMaterial);\r\n\t\t// \t\t\t\t\t\t\t\tscene.add(mesh);\r\n\r\n\t\t// \t\t\t\t\t\t\t\tmainlineArry.push(mesh);\r\n\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t// 回放完毕时，设置回放状态为回放完成\r\n\t\t// \t\t\t\t\t\tif (i >= len - 1) {\r\n\r\n\t\t// \t\t\t\t\t\t\tmake = 0;\r\n\r\n\t\t// \t\t\t\t\t\t\tthat.isplayBack = false;\r\n\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\tclearTimeout(timer);\r\n\r\n\t\t// \t\t\t\t\t}, durationTime * i, data[i], data.length);\r\n\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**\r\n\t\t// \t\t\t * 获取教师打球数据\r\n\t\t// \t\t\t */\r\n\t\t// \t\t\tgetTeacherData: function() {\r\n\t\t// \t\t\t\tconsole.log(\"调用 getTeacherData\");\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tlet url = \"a\";\r\n\t\t// \t\t\t\taxisTeacher = []; //保存x轴\r\n\t\t// \t\t\t\tteacherData = [];\r\n\t\t// \t\t\t\tcurveTeach = [];\r\n\t\t// \t\t\t\tplaybackData = [];\r\n\t\t// \t\t\t\tlet params = {\r\n\t\t// \t\t\t\t\t\"content_id\": contentId, //课程内容id\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\tconsole.log(\"params:\", params);\r\n\t\t// \t\t\t\tlet field = http.verify(\"30110161\", params);\r\n\t\t// \t\t\t\tconsole.log(\"field:\", field);\r\n\r\n\t\t// \t\t\t\tlet list;\r\n\r\n\r\n\t\t// \t\t\t\thttp.request(url, \"POST\", field).then(function(res) {\r\n\r\n\t\t// \t\t\t\t\tlist = res.data_list;\r\n\t\t// \t\t\t\t\tconsole.log(\"输出 list:\", res);\r\n\r\n\t\t// \t\t\t\t\tif (list.length > 0) {\r\n\r\n\t\t// \t\t\t\t\t\tplaybackData = JSON.parse(list[0].ahrs);\r\n\t\t// \t\t\t\t\t\tteacherData = list[0];\r\n\r\n\t\t// \t\t\t\t\t\tapp.globalData.lenTeacher = playbackData.length;\r\n\r\n\r\n\t\t// \t\t\t\t\t\t// 查找速度最小值\r\n\t\t// \t\t\t\t\t\tlet accList = JSON.parse(list[0].acc);\r\n\t\t// \t\t\t\t\t\tspeedMin = Math.abs(accList[0].x + accList[0].y + accList[0].z);\r\n\t\t// \t\t\t\t\t\tfor (let i = 0; i < accList.length; i++) {\r\n\t\t// \t\t\t\t\t\t\tlet accX = accList[i].x;\r\n\t\t// \t\t\t\t\t\t\tlet accY = accList[i].y;\r\n\t\t// \t\t\t\t\t\t\tlet accZ = accList[i].z;\r\n\r\n\t\t// \t\t\t\t\t\t\t// 计算速度\r\n\t\t// \t\t\t\t\t\t\tlet speedAcc = Math.abs(accX + accY + accZ);\r\n\t\t// \t\t\t\t\t\t\tif (speedMin > speedAcc) {\r\n\t\t// \t\t\t\t\t\t\t\tspeedMin = speedAcc;\r\n\r\n\t\t// \t\t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\tconsole.log(\"speedMin：\", speedMin);\r\n\r\n\r\n\r\n\t\t// \t\t\t\t\t\tlet newAhrs = JSON.parse(list[0].gyro);\r\n\t\t// \t\t\t\t\t\tfor (let i = 0; i < newAhrs.length; i++) {\r\n\t\t// \t\t\t\t\t\t\tlet gyro_x = newAhrs[i].x;\r\n\t\t// \t\t\t\t\t\t\tlet gyro_y = newAhrs[i].y;\r\n\t\t// \t\t\t\t\t\t\tlet gyro_z = newAhrs[i].z;\r\n\t\t// \t\t\t\t\t\t\tlet curveData = Math.abs(gyro_x + gyro_y + gyro_z); //计算平方数\r\n\t\t// \t\t\t\t\t\t\tif (curveTeach.length == 0) {\r\n\t\t// \t\t\t\t\t\t\t\tcurveTeach.push(0); //使发力曲线从0开始绘制\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\tcurveTeach.push(curveData);\r\n\t\t// \t\t\t\t\t\t\taxisTeacher.push(\"\");\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\tconsole.log(\"教师数据发力曲线：curveTeach:\", curveTeach);\r\n\r\n\t\t// \t\t\t\t\t\t// 找到速度最大值\r\n\t\t// \t\t\t\t\t\tlet maxValue = curveTeach[0];\r\n\t\t// \t\t\t\t\t\tfor (let j = 0; j < curveTeach.length; j++) {\r\n\t\t// \t\t\t\t\t\t\tif (j > 0) {\r\n\t\t// \t\t\t\t\t\t\t\tif (maxValue < curveTeach[j]) {\r\n\r\n\t\t// \t\t\t\t\t\t\t\t\t// 最大值的下标\r\n\t\t// \t\t\t\t\t\t\t\t\tmaxIndexTeach = j;\r\n\t\t// \t\t\t\t\t\t\t\t\tmaxValue = curveTeach[j];\r\n\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\t\tmax = util.findcode(curveTeach);\r\n\r\n\t\t// \t\t\t\t\t\t// that.initGraph(curveTeach, '', axisTeacher, true); //根据教师数据 绘制教师曲线\r\n\t\t// \t\t\t\t\t\tlet series = [{\r\n\t\t// \t\t\t\t\t\t\t\"name\": \"加速度\",\r\n\t\t// \t\t\t\t\t\t\t\"data\": curveTeach,\r\n\t\t// \t\t\t\t\t\t}, {\r\n\t\t// \t\t\t\t\t\t\t\"name\": \"\",\r\n\t\t// \t\t\t\t\t\t\t\"data\": \"\",\r\n\t\t// \t\t\t\t\t\t}];\r\n\r\n\t\t// \t\t\t\t\t\tlet chartData = {\r\n\t\t// \t\t\t\t\t\t\t\"categories\": axisTeacher,\r\n\t\t// \t\t\t\t\t\t\t\"series\": series,\r\n\t\t// \t\t\t\t\t\t}\r\n\t\t// \t\t\t\t\t\tthat.chartData = chartData;\r\n\t\t// \t\t\t\t\t\tconsole.log(\"curveTeach:\" + JSON.stringify(curveTeach));\r\n\t\t// \t\t\t\t\t\tconsole.log(\"series:\" + JSON.stringify(series));\r\n\t\t// \t\t\t\t\t\tconsole.log(\"chartData:\" + JSON.stringify(chartData));\r\n\r\n\t\t// \t\t\t\t\t} else {\r\n\r\n\t\t// \t\t\t\t\t\tthat.front = false;\r\n\t\t// \t\t\t\t\t\tthat.back = false;\r\n\t\t// \t\t\t\t\t\tthat.play = false;\r\n\t\t// \t\t\t\t\t}\r\n\r\n\r\n\t\t// \t\t\t\t});\r\n\r\n\t\t// \t\t\t},\r\n\r\n\r\n\t\t// \t\t\t// 更新data 切换选中状态 训练模式\r\n\t\t// \t\t\tselectedXunlian: function(e) {\r\n\t\t// \t\t\t\tthis.currentSelectTripType = e.currentTarget.dataset.id;\r\n\t\t// \t\t\t\tthis.currentSelectTripOpen = true;\r\n\r\n\r\n\t\t// \t\t\t\tapp.globalData.isCurrentSelectTripType = 'training';\r\n\r\n\t\t// \t\t\t\tconsole.log(\"输出：\", app.globalData.isCurrentSelectTripType);\r\n\r\n\t\t// \t\t\t\tconsole.log(\"currentSelectTripType:\", this.currentSelectTripType);\r\n\r\n\t\t// \t\t\t\t// 清除学习模式和训练模式底部 轨迹\r\n\t\t// \t\t\t\tfor (let j = 0; j < mainlineArryGet.length; j++) {\r\n\t\t// \t\t\t\t\tscene.remove(mainlineArryGet[j]);\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t\t// 清除训练模式 挥拍轨迹\r\n\t\t// \t\t\t\tfor (let j = 0; j < mainlineArry.length; j++) {\r\n\t\t// \t\t\t\t\tscene.remove(mainlineArry[j]);\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\tmainlineArryGet = []; //面\r\n\t\t// \t\t\t\tmainlineArry = []; //面\r\n\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t// 学习模式\r\n\t\t// \t\t\tselectedStudy: function(e) {\r\n\t\t// \t\t\t\t// this.playBackData(); //切换学习模式，回放一次轨迹\r\n\r\n\t\t// \t\t\t\tthis.currentSelectTripType = e.currentTarget.dataset.id;\r\n\t\t// \t\t\t\tthis.currentSelectTripOpen = false;\r\n\t\t// \t\t\t\tthis.front = false;\r\n\t\t// \t\t\t\tthis.play = false;\r\n\t\t// \t\t\t\tthis.back = false;\r\n\r\n\t\t// \t\t\t\tapp.globalData.isCurrentSelectTripType = 'study';\r\n\t\t// \t\t\t\tthis.isCurrentSelectTripType = app.globalData.isCurrentSelectTripType;\r\n\r\n\t\t// \t\t\t\tconsole.log(\"输出：\", app.globalData.isCurrentSelectTripType);\r\n\t\t// \t\t\t\tconsole.log(\"currentSelectTripType:\", this.currentSelectTripType);\r\n\r\n\t\t// \t\t\t\t// 清除学习模式和训练模式底部 轨迹\r\n\t\t// \t\t\t\tfor (let j = 0; j < mainlineArryGet.length; j++) {\r\n\t\t// \t\t\t\t\tscene.remove(mainlineArryGet[j]);\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t\t// 清除训练模式 挥拍轨迹\r\n\t\t// \t\t\t\tfor (let j = 0; j < mainlineArry.length; j++) {\r\n\t\t// \t\t\t\t\tscene.remove(mainlineArry[j]);\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\tmainlineArryGet = []; //面\r\n\t\t// \t\t\t\tmainlineArry = []; //面\r\n\r\n\t\t// \t\t\t},\r\n\r\n\r\n\t\t// \t\t\t/**\r\n\t\t// \t\t\t * 查询训练目标次数\r\n\t\t// \t\t\t */\r\n\t\t// \t\t\ttrainContent: function() {\r\n\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tlet url = \"a\";\r\n\r\n\t\t// \t\t\t\tlet params = {\r\n\t\t// \t\t\t\t\t\"course_id\": courseId,\r\n\t\t// \t\t\t\t\t\"content_id\": contentId,\r\n\t\t// \t\t\t\t\t'openid': openId,\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\tlet field = http.verify(\"30110127\", params);\r\n\r\n\t\t// \t\t\t\thttp.request(url, \"POST\", field).then(function(res) {\r\n\r\n\t\t// \t\t\t\t\tlet list = res.data.rds[0];\r\n\t\t// \t\t\t\t\tconsole.log(\"list:\", list);\r\n\r\n\r\n\t\t// \t\t\t\t\tthat.content_count = list.content_count;\r\n\t\t// \t\t\t\t\tthat.train_count = list.trainCount;\r\n\t\t// \t\t\t\t});\r\n\t\t// \t\t\t},\r\n\r\n\r\n\r\n\t\t// \t\t\t/**\r\n\t\t// \t\t\t * 点击开始\r\n\t\t// \t\t\t */\r\n\t\t// \t\t\tupdateStartTrain: function() {\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tlet connectStatus = that.connectStatus;\r\n\r\n\t\t// \t\t\t\t//未连接蓝牙不允许点击 开始按钮\r\n\t\t// \t\t\t\tif (connectStatus == false) { //未连接蓝牙\r\n\t\t// \t\t\t\t\twx.showToast({\r\n\t\t// \t\t\t\t\t\ttitle: '请先连接蓝牙',\r\n\t\t// \t\t\t\t\t\ticon: 'none',\r\n\t\t// \t\t\t\t\t\tduration: 2000\r\n\t\t// \t\t\t\t\t})\r\n\t\t// \t\t\t\t} else {\r\n\r\n\t\t// \t\t\t\t\tthat.bEnd = false;\r\n\r\n\t\t// \t\t\t\t\tapp.globalData.isClick = false;\r\n\r\n\r\n\t\t// \t\t\t\t\tstartTime = Date.parse(new Date());\r\n\t\t// \t\t\t\t\twx.setStorageSync('startTime', startTime)\r\n\t\t// \t\t\t\t\tlet url = \"a\";\r\n\t\t// \t\t\t\t\tlet params = {\r\n\t\t// \t\t\t\t\t\t\"course_id\": courseId, //课程id\r\n\t\t// \t\t\t\t\t\t\"content_id\": contentId, //课程内容id\r\n\t\t// \t\t\t\t\t\t'openid': openId,\r\n\t\t// \t\t\t\t\t\t\"startTime\": startTime,\r\n\t\t// \t\t\t\t\t}\r\n\r\n\t\t// \t\t\t\t\tlet field = http.verify(\"30110140\", params);\r\n\r\n\t\t// \t\t\t\t\thttp.request(url, \"POST\", field).then(function(res) {\r\n\r\n\t\t// \t\t\t\t\t\tlet dateTime = util.formatTime(Date.parse(new Date())).substring(0, 10);\r\n\r\n\t\t// \t\t\t\t\t\tthat.date = dateTime;\r\n\t\t// \t\t\t\t\t\tthat.querySimilarity(dateTime); //点击开始，重新查询相似度等数据\r\n\r\n\t\t// \t\t\t\t\t});\r\n\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t},\r\n\r\n\t\t// \t\t\t/**\r\n\t\t// \t\t\t * 上传数据\r\n\t\t// \t\t\t */\r\n\t\t// \t\t\tupdateEndTrain: function() {\r\n\r\n\t\t// \t\t\t\tlet that = this;\r\n\t\t// \t\t\t\tthat.bEnd = true;\r\n\r\n\t\t// \t\t\t\tapp.globalData.isClick = true\r\n\r\n\t\t// \t\t\t\tconsole.log(\"点击结束：\", that.bEnd);\r\n\r\n\t\t// \t\t\t\tlet url = \"a\";\r\n\r\n\t\t// \t\t\t\tlet params = {\r\n\t\t// \t\t\t\t\t\"course_id\": courseId, //课程id\r\n\t\t// \t\t\t\t\t\"content_id\": contentId, //课程内容id\r\n\t\t// \t\t\t\t\t'openid': openId,\r\n\t\t// \t\t\t\t\t\"startTime\": startTime,\r\n\t\t// \t\t\t\t\t\"endTime\": Date.parse(new Date()),\r\n\t\t// \t\t\t\t\t\"list\": uni.getStorageSync('yqData'),\r\n\t\t// \t\t\t\t}\r\n\r\n\t\t// \t\t\t\tlet field = http.verify(\"30110140\", params);\r\n\r\n\t\t// \t\t\t\thttp.request(url, \"POST\", field).then(function(res) {\r\n\t\t// \t\t\t\t\t//////console.log(\"上传数据\", res);\r\n\t\t// \t\t\t\t\t//清除开始时间\r\n\t\t// \t\t\t\t\t// wx.removeStorageSync(\"startTime\");\r\n\t\t// \t\t\t\t\tuni.removeStorageSync(\"yqData\");\r\n\r\n\t\t// \t\t\t\t\tuni.showToast({\r\n\t\t// \t\t\t\t\t\ttitle: '上传成功',\r\n\t\t// \t\t\t\t\t})\r\n\r\n\t\t// \t\t\t\t\tlet dateTime = util.formatTime(Date.parse(new Date())).substring(0, 10);\r\n\r\n\t\t// \t\t\t\t\tthat.date = dateTime;\r\n\t\t// \t\t\t\t\tthat.querySimilarity(dateTime); //点击结束，重新查询相似度等数据\r\n\r\n\t\t// \t\t\t\t});\r\n\t\t// \t\t\t},\r\n\r\n\r\n\t\t// \t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tmargin: 0;\r\n\t\tpadding: 0;\r\n\t\theight: 100%;\r\n\t\tletter-spacing: 2px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.canvas {\r\n\t\twidth: 100%;\r\n\t\theight: 300px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.canvas-style {\r\n\t\twidth: 85%;\r\n\t\theight: 250px;\r\n\r\n\t}\r\n\r\n\t.canvas-down {\r\n\t\twidth: 90%;\r\n\t\theight: auto;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tflex-direction: column;\r\n\t}\r\n\r\n\t.canvas-button {\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\theight: 30px;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t.canvas-button-left {\r\n\t\twidth: 100%;\r\n\t\theight: 30px;\r\n\t\tfont-size: 15px;\r\n\t\tborder-radius: 15px;\r\n\t\tcolor: #617FFB;\r\n\t\ttext-align: center;\r\n\t\tborder: #617FFB solid 1px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.canvas-button-right {\r\n\t\twidth: 100%;\r\n\t\ttext-align: center;\r\n\t\tline-height: 30px;\r\n\t\tborder-radius: 15px;\r\n\t\tfont-size: 15px;\r\n\t\tborder: #FF6060 solid 1px;\r\n\t\tcolor: #FF6060;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.canvas-button-play {\r\n\t\tfont-size: 15px;\r\n\t\twidth: 100%;\r\n\t\tcolor: #617FFB;\r\n\t\ttext-align: center;\r\n\t\tline-height: 30px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.button-left {\r\n\t\twidth: 100px;\r\n\t\tborder-radius: 15px;\r\n\t\tborder: #617FFB solid 1px;\r\n\t}\r\n\r\n\t.button-left-unable {\r\n\t\twidth: 100px;\r\n\t\tcolor: #C2C2C2;\r\n\t\tborder-radius: 15px;\r\n\t\tborder: #C2C2C2 solid 1px;\r\n\t}\r\n\r\n\t.canvas-text {\r\n\t\twidth: 100%;\r\n\t\theight: auto;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: space-around;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t.canvas-left {\r\n\t\twidth: 65%;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tline-height: 25px;\r\n\t}\r\n\r\n\r\n\t.canvas-text-up {\r\n\t\tcolor: #FFA840;\r\n\t\tfont-size: 15px;\r\n\t}\r\n\r\n\t.canvas-text-down {\r\n\t\tcolor: #343434;\r\n\t\tfont-size: 15px;\r\n\t\tpadding-top: 5px;\r\n\t}\r\n\r\n\r\n\r\n\t.video-style {\r\n\t\twidth: 100%;\r\n\t\theight: 200px;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.train-botton {\r\n\t\twidth: 90%;\r\n\t\tmargin: auto;\r\n\t}\r\n\r\n\t.train-performance {\r\n\t\twidth: 100%;\r\n\t\theight: 33px;\r\n\t\tfont-size: 14px;\r\n\t\tletter-spacing: 6px;\r\n\t\tbackground: #FFA73F;\r\n\t\tmargin-top: 14px;\r\n\t\tcolor: white;\r\n\t\tline-height: 33px;\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 15px;\r\n\t}\r\n\r\n\t.train-continue {\r\n\t\twidth: 100%;\r\n\t\theight: 33px;\r\n\t\tfont-size: 14px;\r\n\t\tletter-spacing: 6px;\r\n\t\tbackground: #617FFB;\r\n\t\tmargin-top: 14px;\r\n\t\tcolor: white;\r\n\t\tline-height: 33px;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\r\n\t.result {\r\n\t\twidth: 100%;\r\n\t\tpadding-top: 25px;\r\n\t}\r\n\r\n\t.result-title {\r\n\t\tfont-size: 17px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #343434;\r\n\t\tpadding-left: 10px;\r\n\t}\r\n\r\n\t.result-choose {\r\n\t\twidth: 100%;\r\n\t\theight: 150px;\r\n\t}\r\n\r\n\t.result-number {\r\n\t\twidth: 100%;\r\n\t\theight: 50px;\r\n\t\tpadding-top: 6px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-around;\r\n\t\tflex-direction: row;\r\n\t}\r\n\r\n\t.result-number a {\r\n\t\twidth: 25px;\r\n\t\theight: 25px;\r\n\t\tborder-radius: 50%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.result-number-img {\r\n\t\twidth: 11px;\r\n\t\theight: 19px;\r\n\t}\r\n\r\n\t.result-take {\r\n\t\twidth: 100%;\r\n\t\theight: 50px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tflex-direction: row;\r\n\t\tpadding-left: 10px;\r\n\t\tfont-size: 15px;\r\n\t}\r\n\r\n\t.result-input {\r\n\t\twidth: 60px;\r\n\t\theight: 30px;\r\n\t\tborder-radius: 5px;\r\n\t\tmargin-left: 5px;\r\n\t\tmargin-right: 5px;\r\n\t\tborder: #6280FB solid 1px;\r\n\t}\r\n\r\n\t.result-button {\r\n\t\twidth: 100px;\r\n\t\theight: 35px;\r\n\t\tfont-size: 14px;\r\n\t\tborder-radius: 15px;\r\n\t\tborder: #6280FB 1px solid;\r\n\t\tcolor: #6280FB;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-right: 5px;\r\n\t\tbackground: white;\r\n\t}\r\n\r\n\t/*下面数据部分*/\r\n\t.bottom-data {\r\n\t\t/* width: 325px; */\r\n\t\twidth: 95%;\r\n\t\theight: 106px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\r\n\t}\r\n\r\n\t.strength,\r\n\t.speed {\r\n\t\twidth: 90px;\r\n\t\tbox-shadow: 0px 8px 35px 0px rgba(217, 217, 217, 0.5);\r\n\t\tborder-radius: 10px;\r\n\t\tmargin: 0 auto;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tpadding: 30px 0;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.strength {\r\n\t\tmargin-right: 25px;\r\n\t}\r\n\r\n\t.speed {\r\n\t\tmargin-left: 25px;\r\n\t}\r\n\r\n\t.strength-icon,\r\n\t.speed-icon {\r\n\t\twidth: 30px;\r\n\t\theight: 30px;\r\n\t\tpadding-bottom: 15px;\r\n\t}\r\n\r\n\t.strength-text,\r\n\t.speed-text {\r\n\t\tpadding-bottom: 10px;\r\n\t\tfont-size: 20px;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.strength-text2,\r\n\t.speed-text2 {\r\n\t\tfont-size: 15px;\r\n\t}\r\n\r\n\t.strength-text,\r\n\t.strength-text2 {\r\n\t\tcolor: #FF6060;\r\n\t}\r\n\r\n\t.speed-text,\r\n\t.speed-text2 {\r\n\t\tcolor: #FFC560;\r\n\t}\r\n\r\n\t.bottom-performance {\r\n\t\twidth: 90%;\r\n\t\theight: 33px;\r\n\t\tfont-size: 14px;\r\n\t\tletter-spacing: 6px;\r\n\t\tbackground: #617FFB;\r\n\t\tcolor: white;\r\n\t\tline-height: 33px;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.canvas-right {\r\n\t\twidth: 50%;\r\n\t\theight: 53px;\r\n\t}\r\n\r\n\t.canvas-right-button {\r\n\t\twidth: 20%;\r\n\t\theight: 53px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.canvas-right-button-checkedStyle {\r\n\t\twidth: 60px;\r\n\t\theight: 30px;\r\n\t\tcolor: #617FFB;\r\n\t\tfont-size: 13px;\r\n\t\tborder-radius: 15px;\r\n\t\tborder: #617FFB solid 1px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 2px;\r\n\t}\r\n\r\n\t.canvas-right-button-style {\r\n\t\twidth: 60px;\r\n\t\theight: 30px;\r\n\t\tcolor: #C2C2C2;\r\n\t\tfont-size: 13px;\r\n\t\tborder-radius: 15px;\r\n\t\tborder: #C2C2C2 solid 1px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 3px;\r\n\t}\r\n\r\n\t.canvas-right-button-checkedStyleBottom {\r\n\t\twidth: 60px;\r\n\t\theight: 30px;\r\n\t\tcolor: #617FFB;\r\n\t\tfont-size: 13px;\r\n\t\tborder-radius: 15px;\r\n\t\tborder: #617FFB solid 1px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 13px;\r\n\t}\r\n\r\n\t.canvas-right-button-styleBottom {\r\n\t\twidth: 60px;\r\n\t\theight: 30px;\r\n\t\tcolor: #C2C2C2;\r\n\t\tfont-size: 13px;\r\n\t\tborder-radius: 15px;\r\n\t\tborder: #C2C2C2 solid 1px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 13px;\r\n\t}\r\n\r\n\r\n\t.correct-text {\r\n\t\twidth: 40px;\r\n\t\theight: 40px;\r\n\t\tposition: relative;\r\n\t\tleft: 50%;\r\n\t}\r\n\r\n\t.mychart {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tfont-size: 15px;\r\n\t}\r\n\r\n\r\n\t/*电量*/\r\n\t.electric {\r\n\t\twidth: 20px;\r\n\t\theight: 40px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tposition: relative;\r\n\t\ttop: -45%;\r\n\t}\r\n\r\n\r\n\t/* 显示断开蓝牙时的电量 */\r\n\t.battery-show {\r\n\t\tcolor: #FF6060;\r\n\t\tfont-size: 16px;\r\n\t\tfont-weight: 600;\r\n\t\tposition: absolute;\r\n\t\tleft: 1px;\r\n\t\ttop: -8px;\r\n\t\tz-index: 100;\r\n\t\ttransform: rotate(-90deg);\r\n\t}\r\n\r\n\t/* 显示电量 */\r\n\t.battery {\r\n\t\tcolor: #34495e;\r\n\t\tborder: 1px solid currentColor;\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 25px;\r\n\t\theight: 10px;\r\n\t\tposition: relative;\r\n\t\tborder-radius: 2px;\r\n\t\tdisplay: border-box;\r\n\t\tmargin-top: 10px;\r\n\t\ttransform: rotate(-90deg);\r\n\t}\r\n\r\n\t.battery::before,\r\n\r\n\t.battery::after {\r\n\t\tcontent: \"\";\r\n\r\n\t\tposition: absolute;\r\n\r\n\t}\r\n\r\n\t.battery::before {\r\n\t\ttop: 2px;\r\n\r\n\t\tbottom: 2px;\r\n\r\n\t\tright: -3px;\r\n\r\n\t\twidth: 1px;\r\n\r\n\t\tdisplay: border-box;\r\n\r\n\t\tborder: 1px solid currentColor;\r\n\r\n\t\tborder-left: 0;\r\n\r\n\t}\r\n\r\n\t.battery::after {\r\n\t\ttop: 0;\r\n\r\n\t\tbottom: 0;\r\n\r\n\t\tleft: 0;\r\n\r\n\t\tright: 0;\r\n\r\n\t\tmargin: 1px;\r\n\r\n\t\tborder-radius: 1px;\r\n\r\n\t\tbackground-color: currentColor;\r\n\r\n\t\ttransition: right 500ms;\r\n\r\n\t}\r\n\r\n\t.battery.low {\r\n\t\tcolor: #c0392b;\r\n\r\n\t}\r\n\r\n\t.battery.low::after {\r\n\t\tright: 80%;\r\n\r\n\t\tborder-top-right-radius: 0;\r\n\r\n\t\tborder-bottom-right-radius: 0;\r\n\r\n\t}\r\n\r\n\t.battery.med {\r\n\t\tcolor: #f39c12;\r\n\r\n\t}\r\n\r\n\t.battery.med::after {\r\n\t\tright: 40%;\r\n\r\n\t\tborder-top-right-radius: 0;\r\n\r\n\t\tborder-bottom-right-radius: 0;\r\n\r\n\t}\r\n\r\n\t.battery.full {\r\n\t\tcolor: #27ae60;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='0'],\r\n\r\n\t.battery[data-charge='1'],\r\n\r\n\t.battery[data-charge='2'] {\r\n\t\tcolor: #c0392b;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='3'],\r\n\r\n\t.battery[data-charge='4'],\r\n\r\n\t.battery[data-charge='5'] {\r\n\t\tcolor: #f39c12;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='6'],\r\n\r\n\t.battery[data-charge='7'],\r\n\r\n\t.battery[data-charge='8'],\r\n\r\n\t.battery[data-charge='9'],\r\n\r\n\t.battery[data-charge='10'] {\r\n\t\tcolor: #27ae60;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='0']::after {\r\n\t\tright: 100%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='1']::after {\r\n\t\tright: 85%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='2']::after {\r\n\t\tright: 80%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='3']::after {\r\n\t\tright: 70%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='4']::after {\r\n\t\tright: 60%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='5']::after {\r\n\t\tright: 50%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='6']::after {\r\n\t\tright: 40%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='7']::after {\r\n\t\tright: 30%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='8']::after {\r\n\t\tright: 20%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='9']::after {\r\n\t\tright: 10%;\r\n\r\n\t}\r\n\r\n\t.battery[data-charge='10']::after {\r\n\t\tright: 0%;\r\n\r\n\t}\r\n\r\n\t.similarity {\r\n\t\tposition: absolute;\r\n\t\tbottom: 0;\r\n\t\tfont-size: 15px;\r\n\t}\r\n\r\n\t.data-result-list {\r\n\t\twidth: 90%;\r\n\t\theight: 35px;\r\n\t\tbackground: #F7F7F7;\r\n\t\tborder-radius: 2px 2px 0px 0px;\r\n\t\tmargin-top: 10px;\r\n\t}\r\n\r\n\t.list-title {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\tbackground: #EFEFEF;\r\n\t}\r\n\r\n\t.list-title .title {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\theight: 35px;\r\n\t\ttext-align: center;\r\n\t\tcolor: #979797;\r\n\t\tfont-size: 12px;\r\n\t}\r\n\r\n\t.list-title .check {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\theight: 35px;\r\n\t\ttext-align: center;\r\n\t\tcolor: #617FFB;\r\n\t\tfont-size: 12px;\r\n\t}\r\n\r\n\t.list-data {\r\n\t\tbackground: #F7F7F7;\r\n\t}\r\n\r\n\t.list-data-checked {\r\n\t\tbackground: #DFE5FE;\r\n\t}\r\n\r\n\t.line {\r\n\t\theight: 1px;\r\n\t\tbackground: #EAE7E7;\r\n\t}\r\n\r\n\t.rotate {\r\n\t\twidth: 90%;\r\n\t\theight: 40px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.im-rotate-left {\r\n\t\twidth: 30px;\r\n\t\theight: 30px;\r\n\t}\r\n\r\n\t.im-rotate-right {\r\n\t\twidth: 30px;\r\n\t\theight: 30px;\r\n\t}\r\n\r\n\r\n\t.top-switch {\r\n\t\tdisplay: flex;\r\n\t\twidth: 100%;\r\n\t\tpadding: 8px 0;\r\n\t}\r\n\r\n\t.switch-type {\r\n\t\tdisplay: flex;\r\n\t\tmargin: 0 auto;\r\n\t\tpadding-left: 15px;\r\n\t}\r\n\r\n\t.switch-type .btn {\r\n\t\tbackground: #E4E8FF;\r\n\t\tpadding: 5px 20px;\r\n\t\tcolor: #98A6FF;\r\n\t\tfont-size: 14px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.switch-type .btn.active {\r\n\t\tbackground: #6076FF;\r\n\t\tcolor: #fff;\r\n\t\tpadding: 5px 20px;\r\n\t\tfont-size: 14px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.im-switch {\r\n\t\twidth: 35px;\r\n\t\theight: 35px;\r\n\t\tmargin: 0;\r\n\t\tpadding-right: 15px;\r\n\t}\r\n\r\n\t.electric-background {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tposition: absolute;\r\n\t\tleft: 0px;\r\n\t}\r\n\r\n\t.electric-img {\r\n\t\twidth: 26px;\r\n\t\theight: 18px;\r\n\r\n\t}\r\n\r\n\r\n\t/* 测试 */\r\n\r\n\r\n\t.listbox {\r\n\t\twidth: 90%;\r\n\t}\r\n\r\n\t.listbox-content {\r\n\t\twidth: 90%;\r\n\t\tmargin-top: 10px;\r\n\t\tmargin-left: 17px;\r\n\t\tbackground: sandybrown;\r\n\t}\r\n\r\n\t.selector {\r\n\t\twidth: 100%;\r\n\t\theight: 30px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\tmargin-top: 10px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.selector-content {\r\n\t\twidth: 90%;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: space-between;\r\n\t\tletter-spacing: 1px;\r\n\t}\r\n\r\n\t.picker {\r\n\t\twidth: 70%;\r\n\t\tcolor: #6076FF;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tfont-size: 15px;\r\n\t}\r\n\r\n\t.take {\r\n\t\twidth: 30%;\r\n\t\tfont-size: 15px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row-reverse;\r\n\t\t/*水平靠右*/\r\n\t}\r\n\r\n\t.choose-img {\r\n\t\twidth: 20px;\r\n\t\theight: 20px;\r\n\t\tposition: relative;\r\n\t\ttop: 5px;\r\n\t}\r\n\r\n\t.canvas-right-train {\r\n\t\twidth: 20%;\r\n\t\theight: 53px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\r\n\t.right-button {\r\n\t\twidth: 25%;\r\n\t\theight: 100%;\r\n\t\tmargin-left: 10px;\r\n\t}\r\n\r\n\t.correct-img {\r\n\t\twidth: 50px;\r\n\t\theight: 50px;\r\n\t}\r\n\r\n\t.correct-imgOne {\r\n\t\twidth: 35px;\r\n\t\theight: 35px;\r\n\r\n\t}\r\n\r\n\t.canvas-similarity {\r\n\t\twidth: 90%;\r\n\t\theight: 35px;\r\n\t\tfont-size: 15px;\r\n\t\tmargin-top: 35px;\r\n\t}\r\n\r\n\t.electricShow {\r\n\t\tfont-size: 20px;\r\n\t}\r\n\r\n\t.charts-box {\r\n\t\twidth: 100%;\r\n\t\theight: 150px;\r\n\t}\r\n\r\n\r\n\t.three {\r\n\t\twidth: 100%;\r\n\t\theight: 50px;\r\n\t}\r\n</style>\n","import mod from \"-!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\install\\\\HBuilderX\\\\HBuilderX.3.1.18.20210609.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&lang=css&\"","var components\ntry {\n  components = {\n    qiunDataCharts: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts\" */ \"@/uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }"],"sourceRoot":""}